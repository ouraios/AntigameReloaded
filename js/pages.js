AGO.Overview={Messages:function(e,t){AGO.dummy=e+t},Run:function(){AGO.Option.is("B01")&&(AGO.Overview.enabled=!0,AGO.Overview.improve=1===AGO.Acc.type),AGO.Overview.Show(),AGO.Building.showConstructions()},Interactive:function(){AGO.Units.activeProduction(),AGO.Overview.Timer(),AGO.Building.displayConstructions()},Complete:function(){window.setTimeout(function(){var e=document.getElementById("Rentabilite_mines");e&&DOM.updateAttribute(e.parentNode,null,"ago-status",1,8)&&DOM.set(e.parentNode,null,null,null,{click:function(){DOM.addEvents("ordre_table","id",{click:AGO.Overview.infocompte})}})},500)},infocompte:function(e){e&&e.target&&(e=DOM.getData(e.target,null,2),OBJ.is(e)&&(e.level=0,e.type=1,e.coords=AGO.Task.trimCoords(e.coords),AGO.Task.updateCoords(e,2,AGO.Task.splitCoords(e.coords)),AGO.Init.Messages("Panel","Action",{action:"set",tab:"Construction",value:e})))},onKeydown:function(e){if(!e.inputType&&!e.cached){if(13===e.keyCode)return document.location.href=AGO.Uni.path+"overview",!1;if(32===e.keyCode)return DOM.click("#planet #moon a, #planet #planet_as_moon a"),e.preventDefault(),!1}return!0},Show:function(){var e,t,a,n;AGO.Option.is("B02")&&DOM.extendClass("inhalt","id","ago_mode_construction"),(e=document.getElementById("detailWrapper"))&&(AGO.Overview.enabled&&(e=e.querySelector("#planetDetails table tbody"))&&1===AGO.Acc.type&&(t=document.createDocumentFragment(),OBJ.iterate(AGO.Item.Resource,function(e){a=DOM.appendTR(t),n=DOM.appendTD(a,"desc",e,11),n=DOM.appendTD(a,"data"),DOM.appendSPAN(n,{id:"ago_overview_production_"+e}),a=DOM.appendTR(t),n=DOM.appendTD(a,"desc"),n=DOM.appendTD(a,"data"),DOM.appendSPAN(n,{class:"ago_overview_storagetime",id:"ago_overview_storagetime_"+e}," ")}),DOM.prependChild(e,t)),(t=document.getElementById("moveCountdown"))&&AGO.Option.is("B02")&&(a="moveProgress"===t.parentNode.id?t.parentNode.parentNode:t.parentNode,DOM.appendSPAN(a,{id:"ago_construction_move"}))),e=e=a=n=null},Timer:function(){AGO.Overview.enabled&&1===AGO.Acc.type&&(OBJ.iterate(AGO.Item.Resource,function(e){var t,a,n,i,l;a=AGO.Units.get(e),l=AGO.Units.get(e+"Storage"),i=AGO.Units.get(e+"Production"),n=AGO.Units.get(e+"Start"),(t=document.getElementById("ago_overview_production_"+e))&&(t.className=l<=a?"overmark":.9*l<=a?"middlemark":"",t.innerHTML=(0<i&&a<l?'<span class="undermark">(+'+STR.formatNumber(Math.floor(3600*i))+") </span>":'<span class="overmark">(0) </span>')+STR.formatNumber(a)+" / "+STR.formatNumber(l)),(t=document.getElementById("ago_overview_storagetime_"+e))&&!AGO.Overview.storage&&(e=0<i&&a<l?Math.floor((l-n)/i):0,t.innerHTML=e?AGO.Time.format(AGO.Time.getFinishTime(e)):" ")}),AGO.Overview.storage=!0)}},AGO.Building={Data:{},Messages:function(e,t){"Display"===e?AGO.Building.Display():"Action"===e&&AGO.Building.Action(t)},Read:function(){var e,t,a,n;for(e=document.querySelectorAll("#inhalt #buttonz li"),n=0;n<e.length;n++)t=e[n].querySelector('.buildingimg a[id^="details"]'),(a=AGO.Item.valid(DOM.getAttribute(t,null,"ref",7)))&&AGO.Units.set(a,DOM.getTextChild(".ecke .level",t,3));OBJ.set(AGO.Units.Data,"page",AGO.App.page),"research"===AGO.App.page&&AGO.Notify.set("Problem",-12)},Run:function(){AGO.Option.is("B00")&&(AGO.Building.enabled=!0),AGO.Building.Show(),AGO.Building.showConstructions()},Interactive:function(){AGO.Building.displayConstructions()},onKeydown:function(e){if(12!==e.inputType){if(65===e.keyCode||77===e.keyCode)return DOM.click("#detail .ago_items_shortcut #ago_items_number[ago-data]"),!1;if(81===e.keyCode)return DOM.setValue("#detail #number",null,"",0,"click"),!1}return 11!==e.inputType||38!==e.keyCode&&40!==e.keyCode||"number"!==e.target.id||DOM.changeInput(e,e.target)},Show:function(){var e,t,a,n,i,l,o,r,s;if(a=VAL.check(AGO.Option.get("B21",2),1,3),n=VAL.check(AGO.Option.get("B21",2),2,3),e=document.getElementById("inhalt"))for(t=(a?" ago_mode_name":"")+(AGO.Option.is("B02")?" ago_mode_construction":""),DOM.extendClass(e,null,t),e=e.querySelectorAll("#buttonz li"),s=0;s<e.length;s++)t=e[s].querySelector('.buildingimg a[id^="details"]'),(r=AGO.Item.valid(DOM.getAttribute(t,null,"ref",7)))&&(l=DOM.getTextChild(".eckeoben span",t,3),AGO.Building.enabled&&(0<l&&l<AGO.Units.get(r)&&+r<200&&(DOM.updateClass(".eckeoben span",t,"overmark"),DOM.addClass(".timeLink span",t.parentNode,"overmark")),a&&(i=DOM.getText("span.textlabel",t,7)||AGO.Label.get(r,11),DOM.appendSPAN(t,"ago_items_textName ago_items_text ago_text_background",i)),!(n&&DOM.hasClass(e[s],null,"on")&&AGO.Option.is("commander"))||l&&a||!VAL.check(AGO.App.page,"shipyard","defense")&&"212"!==r||(i=AGO.Units.get("metal")/(AGO.Item[r].metal||1),l=AGO.Units.get("crystal")/(AGO.Item[r].crystal||1),o=AGO.Units.get("deuterium")/(AGO.Item[r].deuterium||1),(i=STR.formatNumber(Math.floor(Math.min(Math.min(i,l),o))))&&VAL.check(r,"407","408")&&(i=1),DOM.appendSPAN(t,"ago_items_textCount ago_items_text ago_text_background",i)),AGO.Option.is("B04")&&"research"===AGO.App.page&&(Math.abs(AGO.Item.Research[r])>AGO.Units.get(r)?DOM.addClass(".level",t,"ago_color_palered"):AGO.Item.Research[r]<0&&DOM.addClass(".level",t,"ago_color_lightgreen"))))},Content:function(e,t,a){function n(e,t,a,n){t&&(e=DOM.appendLI(e,n,t),a=DOM.appendSPAN(e,{class:"time",id:a}),DOM.appendSPAN(a))}var i,l,o,r,s;a=document.getElementById("description"),e=DOM.updateAttribute("content","id","ago-status",1,8),AGO.Building.enabled&&e&&a&&((l=(i=e.parentNode.parentNode.parentNode).querySelector("div.pic"))&&(DOM.appendChild(e,l.querySelector("a.abort_link")),DOM.appendChild(a,l.querySelector("a.techtree_link")),AGO.Option.is("B11")&&DOM.replaceChildren(l,DOM.create("div",{id:"ago_items_resource"},null,{click:AGO.Building.clickSummary}))),t=e.querySelector("ul.production_info"),r=AGO.Item.valid(DOM.getValue('input[name="type"]',i,7)),t&&r&&(AGO.Building.Data[r]?200<r&&"212"!==r&&DOM.setValue("#number",e,AGO.Building.Data[r].level):(AGO.Building.Data[r]={type:AGO.Acc.type,id:r,time:AGO.Time.parseFormatedTime(DOM.getTextChild("li:first-child .time",t))},AGO.Task.updateCoords(AGO.Building.Data[r],2),r<200?(AGO.Building.Data[r].level=AGO.Units.get(r),AGO.Building.Data[r].increase=1,AGO.Building.updateConstruction(AGO.Building.Data[r]),AGO.Building.Data[r].time/=AGO.Building.Data[r].metal+AGO.Building.Data[r].crystal,AGO.Option.is("B11")&&AGO.Option.is("B12")&&(l=(l=DOM.getTextChild("#buttonz .buildingimg a#details"+r+" .eckeoben span",null,7))?NMR.parseIntAbs(l)-AGO.Building.Data[r].level:0,AGO.Building.Data[r].increase=2*l||1)):AGO.Building.Data[r].level=1,AGO.Building.updateConstruction(AGO.Building.Data[r])),DOM.iterateChildren(t,function(e){(s=DOM.getTextChild(e))&&DOM.updateTextChild(e,null,s.slice(0,32))}),AGO.Option.is("commander")?(VAL.check(r,"1","2","3","212")&&DOM.addClass(t,null,"ago_items_compact"),l=DOM.getChildren(t,2)):l=DOM.getChildren(t,1),DOM.set("li:first-child .time",t,{id:"ago_items_duration",original:DOM.getTextChild(l)}),o=l?l.querySelector(".time"):null,l=document.createDocumentFragment(),VAL.check(r,"1","2","3")?(i=DOM.appendDIV(null,"capacity_display"),DOM.append(i,"p").textContent=AGO.Label.get("B19"),DOM.appendDIV(i,{id:"remainingresources"}),DOM.prependChild(a,i),o&&(DOM.setAttribute(o,null,"id","ago_items_energy"),DOM.appendSPAN(o,"undermark"),n(a=document.createDocumentFragment(),AGO.Label.get("B17"),"ago_items_production"),DOM.before(o.parentNode,a),n(l,AGO.Label.get("212",1),"ago_items_number"))):VAL.check(r,"4","12","212")?(o&&DOM.setAttribute(o,null,"id","ago_items_production"),"212"===r&&(AGO.Units.get("energy")<0&&n(l,AGO.Label.get("B18"),"ago_items_energy"),n(l,(s=DOM.getTextChild("#content > span.level",i).split(":")[0])||AGO.Label.get(r,1),"ago_items_number","ago_items_shortcut")),"12"===r&&n(l,AGO.Label.get("F67"),"ago_items_detail")):VAL.check(r,"22","23","24")?n(l,DOM.getTextChild(".capacity_display > p",a),"ago_items_detail"):"42"===r?n(l," ","ago_items_detail"):200<r&&((r in AGO.Item.Ship||AGO.Uni.defToTF&&r in AGO.Item.Defense)&&n(l,AGO.Label.get("L082"),"ago_items_detail"),n(l,(s=DOM.getTextChild("#content > span.level",i).split(":")[0])||AGO.Label.get(r,1),"ago_items_number","ago_items_shortcut")),t.appendChild(l),DOM.appendSPAN(e,{id:"ago_items_finish"}),AGO.Building.Display()),DOM.addEvents("#detail #number",null,{keyup:AGO.Building.Display,blur:function(){window.setTimeout(AGO.Building.Display,200)}}),DOM.addEventsAll("#content ul.production_info",null,{click:AGO.Building.clickInfo}),DOM.disableActiveElement(),DOM.disableAutocomplete()),i=l=a=l=i=a=null},Display:function(){var e,t,a,n,i;e=document.getElementById("detail"),a=AGO.Item.valid(DOM.getValue('input[name="type"]',e,7)),AGO.Building.enabled&&e&&a&&(t=OBJ.create(AGO.Building.Task),delete AGO.Building.Task,t.id===a&&(200<a?"level"in t&&DOM.setValue("#number",e,t.level):("level"in t&&(AGO.Building.Data[a].level=t.level),"increase"in t&&(AGO.Building.Data[a].increase=t.increase),"range"in t&&(AGO.Building.Data[a].range=t.range))),200<a&&(AGO.Building.Data[a].level=DOM.getValue("#number",e,2)),t=OBJ.create(AGO.Building.Data[a]),AGO.Building.updateConstruction(t),AGO.Task.updateResources(t),AGO.Task.updateStandardUnits(t),t.increase<0?(t.difference=Math.max(t.level+t.increase+1,0),t.current=Math.max(t.level+t.increase-t.range,0)):0<t.increase?(t.difference=Math.max(t.level+t.increase-1,0),t.current=t.level+t.increase+t.range):t.current=t.difference=t.level,AGO.Building.updateSummary(t),t.duration&&(DOM.updateText("ago_items_duration","id",t.duration,19),DOM.updateText("ago_items_finish","id",AGO.Time.format(AGO.Time.getFinishTime(t.duration)))),VAL.check(a,"1","2","3")?(i=AGO.Ogame.getConsumptionEnergy(a,t.current)-AGO.Ogame.getConsumptionEnergy(a,t.difference),n=AGO.Units.get("energy")-i,AGO.Building.updateValue("ago_items_energy",i,n),i=0<=n?0:Math.ceil(-n/AGO.Ogame.getProductionEnergy("212",1)),n="["+AGO.Label.get("K072").toLowerCase()+". "+i+"]",AGO.Building.updateValue("ago_items_number","",n,{type:"task",tab:"212",data:i}),n=(i=AGO.Ogame.getProductionResources(a,t.current))-AGO.Ogame.getProductionResources(a,t.difference),AGO.Building.updateValue("ago_items_production",i,n),n=AGO.Ogame.getAmortisation(a,t,n),DOM.updateText("#remainingresources",e,n,19)):VAL.check(a,"4","12")?(n=(i=AGO.Ogame.getProductionEnergy(a,t.current))-AGO.Ogame.getProductionEnergy(a,t.difference),AGO.Building.updateValue("ago_items_production",i,n),"12"===a&&(n=(i=AGO.Ogame.getConsumptionDeuterium(a,t.current))-AGO.Ogame.getConsumptionDeuterium(a,t.difference),AGO.Building.updateValue("ago_items_detail",i,n))):"212"===a?(i=AGO.Ogame.getProductionEnergy(a,t.level+AGO.Units.get("212")),n=AGO.Ogame.getProductionEnergy(a,t.level),AGO.Building.updateValue("ago_items_production",i,n),AGO.Units.get("energy")<0?(n=Math.ceil(AGO.Units.get("energy")+AGO.Ogame.getProductionEnergy("212",t.level)),i=Math.abs(AGO.Units.get("energy")),AGO.Building.updateValue("ago_items_energy",i,n),i=Math.ceil(Math.abs(AGO.Units.get("energy"))/AGO.Ogame.getProductionEnergy("212",1)),n="["+AGO.Label.get("K072").toLowerCase()+". "+i+"]",t={type:"task",tab:"212",data:i}):n=t="",AGO.Building.updateValue("ago_items_number",AGO.Building.Data[a].level+AGO.Units.get(a),n,t)):VAL.check(a,"22","23","24")?(n=(i=AGO.Ogame.getStorageCapacity(t.current))-AGO.Ogame.getStorageCapacity(t.difference),AGO.Building.updateValue("ago_items_detail",i,n)):"42"===a?(n=(i=t.current*t.current)?"("+AGO.Acc.galaxy+":"+Math.max(AGO.Acc.system-i+1,1)+" - "+AGO.Acc.galaxy+":"+Math.min(AGO.Acc.system+i-1,AGO.Uni.systems)+")":"",AGO.Building.updateValue("ago_items_detail",i,n)):200<a&&((a in AGO.Item.Ship||AGO.Uni.defToTF&&a in AGO.Item.Defense)&&((t={})[a]=Math.max(AGO.Building.Data[a].level,1),t=AGO.Ogame.getDebris(t,!0),n="("+Math.min(Math.floor(t.total/1e4)/10,20)+"%)",AGO.Building.updateValue("ago_items_detail",t.total,n)),t=(n=DOM.getText("#maxlink",e,7))?{type:"task",tab:a,data:NMR.parseIntAbs(n)}:null,AGO.Building.updateValue("ago_items_number",AGO.Building.Data[a].level+AGO.Units.get(a),n,t)))},updateSummary:function(t){function e(e,t,a,n,i){var l;return l=JSON.stringify({type:"setting",data:n}),e=DOM.append(e,"ul",i),t=DOM.appendLI(e,{class:"tooltip",title:AGO.Label.get(n),"ago-data":l},t),DOM.appendSPAN(t,"ago_items_resource_value",a,2,0),e}var a,n,i,l,o,r,s,d,u,c,O;(a=document.getElementById("ago_items_resource"))&&(n=document.createDocumentFragment(),i=DOM.appendDIV(n,"ago_items_resource_header"),t.reserved=1,c=t.increase<0?"ago_icon_reserved_red tooltip":"ago_icon_reserved tooltip",DOM.appendA(i,{class:c,title:AGO.Label.get("I0T")},null,{message:{page:"Panel",role:"Action",data:{action:"set",tab:"Construction",value:t}}}),DOM.appendA(i,"icon icon_skip_back",null,'{"type":"decreaseRange"}'),DOM.appendA(i,"icon icon_rewind",null,'{"type":"decrease"}'),t.id<200?(c=HTML.classStatus(t.increase),d=t.level+t.increase,d=(u=VAL.status(t.increase,-1*t.range,0,t.range))?d+"-"+(d+u):d):(c=HTML.classStatus(1),d=t.level),DOM.appendSPAN(i,c,d,8),DOM.appendA(i,"icon icon_fastforward",null,'{"type":"increase"}'),DOM.appendA(i,"icon icon_skip",null,'{"type":"increaseRange"}'),t.reserved=0,DOM.appendA(i,{class:"icon icon_info tooltip",title:AGO.Label.get("I0T")},null,{message:{page:"Panel",role:"Action",data:{action:"set",tab:"Construction",value:t}}}),r={},s={},d=AGO.Option.is("B31")?" ("+AGO.Label.get(["B36","B37","B38"][AGO.Option.get("B35",2)])+")":"",O=AGO.Option.is("B31")?t.standardunits:t.resources,i=e(n,AGO.Label.get("I3A")+d,O,"B31"),OBJ.iterate(AGO.Item.Resource,function(e){r[e]=AGO.Units.get(e),0<t[e]&&(r[e]-=t[e],s[e]=r[e]<0?Math.abs(r[e]):0,o=DOM.appendLI(i,"",e,11),DOM.appendSPAN(o,"ago_items_resource_value",t[e],2))}),AGO.Task.updateResources(s),AGO.Task.updateStandardUnits(s),O=AGO.Option.is("B31")?s.standardunits:s.resources,i=e(n,AGO.Label.get("I39")+d,O,"B31"),OBJ.iterate(AGO.Item.Resource,function(e){o=DOM.appendLI(i,"",e,11),c=r[e]<0?"ago_color_palered":"ago_color_lightgreen",DOM.appendSPAN(o,"ago_items_resource_value "+c,r[e],2)}),d=AGO.Label.get("F24")+(AGO.Option.is("B15")?" ("+AGO.Label.get("I39")+")":""),O=AGO.Option.is("B15")?s.resources:t.resources,i=e(n,d,O,"B15","ago_items_resource_cargo"),0<O&&(u=AGO.Item.check(AGO.Option.get("B16",2),AGO.Item.ShipTransport,"203"),o=DOM.appendLI(i,{class:"ago_items_resource_cargo tooltipRel tooltipClose tooltipRight",rel:"ago_items_resource_cargo"},u,11),DOM.appendSPAN(o,"ago_items_resource_value",Math.ceil(O/AGO.Item[u].capacity),3),i=DOM.appendDIV(n,{class:"htmlTooltip",id:"ago_items_resource_cargo"},{display:"none"}),DOM.append(i,"h1").textContent=d,DOM.appendDIV(i,"splitLine"),(l=DOM.append(i,"ul","ListLinks")).addEventListener("click",AGO.Building.clickTooltip,!1),OBJ.iterate(AGO.Item.ShipTransport,function(e){o=DOM.appendLI(l,{"ago-data":JSON.stringify({option:"B16",data:e})},e,11),DOM.appendSPAN(o,"ago_items_resource_value",Math.ceil(O/AGO.Item[e].capacity),3)})),DOM.replaceChildren(a,n),a=n=i=l=o=null)},updateValue:function(e,t,a,n){(e=document.getElementById(e))&&("string"==typeof t?DOM.updateTextChild(e,null,t):DOM.updateTextChild(e,null,t||"0",t?4:0),n&&DOM.setData(e,null,n),"string"==typeof a?DOM.updateText("span",e,a):(t=a?(0<a?"(+":"(")+STR.formatNumber(Math.ceil(a),!0)+")":"(0)",(t=DOM.updateText("span",e,t))&&DOM.updateClass(t,null,HTML.classStatus(a))))},Action:function(e){var t;OBJ.is(e)&&AGO.Item.valid(e.id)&&(t=DOM.getValue('#planet input[name="type"]',null,7),(AGO.Building.Task=e).id===t?AGO.Building.Display():DOM.click('#buttonz a.detail_button[ref="'+e.id+'"]'))},clickTooltip:function(e){e&&e.target&&((e=DOM.getData(e.target,null,2)).option&&(AGO.Option.set(e.option,e.data,2),AGO.Global.message({role:"hideAll"}),AGO.Building.Display()))},clickInfo:function(e){e&&e.target&&("task"===(e=DOM.getData(e.target,null,2)).type&&AGO.Building.Action({id:e.tab,level:+e.data}))},clickSummary:function(e){var t,a;e&&e.target&&(a=DOM.getValue('#detail input[name="type"]',null,7),e=DOM.getData(e.target,null,2),OBJ.is(e.message)&&AGO.Init.Messages(e.message.page,e.message.role,e.message.data),"setting"===e.type?(AGO.Option.set(e.data,AGO.Option.is(e.data)?0:1,1),AGO.Building.Display()):a&&AGO.Building.Data[a]&&(a<200?((t={increase:1,decrease:-1}[e.type]||0)&&(AGO.Building.Data[a].increase+=t),(t={increaseRange:1,decreaseRange:-1}[e.type]||0)&&AGO.Building.Data[a].increase&&(AGO.Building.Data[a].range+=t)):(t={increase:1,decrease:-1,increaseRange:10,decreaseRange:-10}[e.type]||0)&&(AGO.Building.Data[a].level=Math.max(AGO.Building.Data[a].level+t,1),DOM.setValue("#detail #number",null,AGO.Building.Data[a].level,8)),AGO.Building.Display()))},showConstructions:function(){function e(e,t){var a,n,i;(a=document.getElementById(e))&&(n=a.parentNode.parentNode.parentNode.children)&&3<n.length&&((i=n[1].querySelector("td.desc"))&&3==+i.firstChild.nodeType&&(i.firstChild.textContent=STR.check(i.firstChild.textContent).replace(/niveau/g,"")),"shipyard"===t?(i=document.getElementById("shipSumCount7"),DOM.addClass(i,null,"ago_color_limegreen"),DOM.appendChild(n[0].querySelector("th"),i),DOM.set("td.building",n[1],{valign:"",rowspan:"3"}),a=DOM.appendTR(null,"data"),i=DOM.appendTD(a,"desc"),DOM.appendSPAN(i,{id:"ago_construction_"+t,class:"ago_construction_finishtime"}," "),DOM.after(n[2],a),(i=n[2].querySelector("br"))&&i.parentNode.removeChild(i)):(i="building"===t&&AGO.Planets.Get("active","construction")<0?" ago_color_palered":"",DOM.addClass(a,null,"ago_construction_time"+i),i&&DOM.addClass(".level",n[1],i),(i=a.parentNode).className="desc",DOM.appendChild(n[2].querySelector("td"),a),DOM.appendSPAN(i,{id:"ago_construction_"+t,class:"ago_construction_finishtime"}," ")))}AGO.Option.is("B02")&&(e("Countdown","building"),e("researchCountdown","research"),e("shipAllCountdown7","shipyard"))},displayConstructions:function(){function e(e,t){DOM.setText("ago_construction_"+e,"id",AGO.Time.format(AGO.Time.getFinishTime(t)))}var t,a,n,i,l;if(AGO.Option.is("B02")&&(t=AGO.Init.Script())){if((a=t.match(/baulisteCountdown\(getElementByIdWithCache\(["']\w+["']\)\,\s*\d*/gi))&&a.length)for(l=0;l<a.length;l++)i=(n=a[l].match(/["'](\w+)["']\)\,\s*(\d*)/i))[1],n=NMR.parseIntAbs(n[2]),"Countdown"===i&&e("building",n),"researchCountdown"===i&&e("research",n),"moveCountdown"===i&&e("move",n);(a=t.match(/shipCountdown\((\s*getElementByIdWithCache\(["']\w+["']\)\,)+(\s*\d*\,){3,3}/i))&&a.length&&e("shipyard",NMR.parseIntFormat(a[2]))}},updateConstruction:function(e){var t,a,n,i,l,o,r;if(OBJ.is(e)&&AGO.Item.valid(e.id))if(t=e.id,OBJ.copy({metal:0,crystal:0,deuterium:0,resources:0,duration:0},e),t in AGO.Item.Ship||t in AGO.Item.Defense)for(r in OBJ.copy({level:Math.max(e.level,1),increase:0,range:0,duration:e.time*Math.max(e.level,1)},e),AGO.Item.Resource)AGO.Item[t][r]&&(e[r]=AGO.Item[t][r]*e.level,e.resources+=e[r]);else if(AGO.Item[t].factor){for(r in e.increase=t in AGO.Item.Research?Math.max(e.increase||0,0):Math.max(e.increase||0,-1*e.level),e.range=e.reserved?0:e.increase<0?Math.max(Math.min(e.level+e.increase,e.range||0),0):Math.max(e.range||0,0),e.increase<0?(n=Math.max(e.level+e.increase,0),a=Math.max(n-e.range,0),i=4*AGO.Units.get("121")):(0<e.increase?n=(a=e.level+e.increase)+e.range:a=n=e.level,i=0),e.start=a,e.stop=n,l={metal:0,crystal:0},AGO.Item.Resource)if(AGO.Item[t][r]){for(o=a;o<=n;o++)e[r]+=Math.floor(AGO.Item[t][r]*Math.pow(AGO.Item[t].factor,o-1));l[r]=e[r],i&&(e[r]=Math.floor(e[r]-e[r]/100*i)),e.resources+=e[r]}e.duration=Math.floor((l.metal+l.crystal)*e.time)}}},AGO.Resources=AGO.Station=AGO.Research=AGO.Shipyard=AGO.Defense=AGO.Building,AGO.ResourcesSettings={Run:function(){AGO.ResourcesSettings.Show()},Show:function(){function e(e){e&&(e=DOM.getAttribute(e.currentTarget,null,"rel"),DOM.setAll("#inhalt table.list td > select",null,null,null,null,{value:e}),DOM.click('#inhalt .factorbutton input[type="submit"]',null))}var t;(t=document.getElementById("inhalt"))&&(t=t.querySelector(".factorbutton"))&&(DOM.set(t.parentNode,null,null,{width:"580px",padding:"8px"}),DOM.append(t,"input",{class:"btn_blue",type:"button",value:"0%",rel:"0"},{marginLeft:"12px"},{click:e}),DOM.append(t,"input",{class:"btn_blue",type:"button",value:"100%",rel:"100"},{marginLeft:"12px"},{click:e})),t=t=null}},AGO.Trader={Content:function(){DOM.disableActiveElement(),DOM.disableAutocomplete()}},AGO.Alliance={Content:function(e,t,a){"allianceoverview"===e&&DOM.updateAttribute("allyMemberlist","id","ago-status",1,8)&&(DOM.click("#link11.opened"),DOM.click("#link12.closed")),DOM.disableActiveElement(),DOM.disableAutocomplete()}};