if(!AGO)var AGO={};AGO.Main={Messages:function(e,t){"Display"===e&&AGO.Main.Display(t)},Read:function(){var a;a={commander:0,admiral:0,engineer:0,geologist:0,technocrat:0},DOM.iterateChildren(document.getElementById("officers"),function(e){var t=e.className||"";HTML.hasClass(t,"on")&&OBJ.iterate(a,function(e){HTML.hasClass(t,e)&&(a[e]=1)})}),OBJ.iterate(a,function(e){AGO.Option.set(e,a[e])})},Run:function(){var e,t,a,n;if((e=document.getElementById("menuTableTools"))&&(a=(t=document.createDocumentFragment()).appendChild(document.createElement("li")),n=DOM.appendSPAN(a,"menu_icon"),DOM.appendA(n,{id:"ago_menubutton_logo",class:"ago_menubutton_logo_inactive"},{click:AGO.Main.clickIcon}),n=DOM.appendA(a,{id:"ago_menubutton",class:"menubutton"},{click:AGO.Main.clickButton}),a=1<AGO.App.beta?"AGOalpha":AGO.App.beta?"AGObeta":"AGO",DOM.appendSPAN(n,"textlabel",a),DOM.appendSPAN(n,{id:"ago_menubutton_coords"}),DOM.prependChild(e,t),!AGO.App.disabled&&30<AGO.Notify.problem&&DOM.setStyleColor("ago_menubutton","id","#FF0000")),AGO.Notify.problem<20){if(e=document.getElementById("logoLink"),t=["","fleet1","movement","galaxy","messages"][AGO.Option.get("O03",2)],e&&t&&(e.parentNode.href=AGO.Uni.path+t),(e=document.getElementById("playerName"))&&(3!==e.childNodes[0].nodeType?DOM.prependChild(e,document.createTextNode(AGO.App.title+" ")):e.childNodes[0].textContent=AGO.App.title+" ",(a=e.querySelector(".status_abbr_outlaw"))&&a.title)){for(t="",a=a.title;n=/\d{1,2}\D/g.exec(a);)t+=n[0]+" ",a=a.split(n[0]).join("");DOM.appendTEXT(e,t)}AGO.Main.modeTitle=AGO.Option.is("O04")?3:0,AGO.Main.Display()}},Complete:function(){AGO.Main.updateTitle(),AGO.Main.Check()},onKeydown:function(e){var t;return!(112<=e.keyCode&&e.keyCode<=123&&AGO.Option.is("U32"))||((t=document.querySelectorAll("#planetList .smallplanet a.planetlink"))&&t[e.keyCode-112]&&DOM.click(e.shiftKey?"a.moonlink":"a.planetlink",t[e.keyCode-112].parentNode),!1)},onSwipe:function(e,t){12===t?AGO.Panel.onSwipe(e):15===t&&AGO.Planets.onSwipe(e)},Display:function(){var e,t,a;a="inactive",AGO.Option.is("I83")&&(e=AGO.Panel.GetActive("Target","coords",6),t=AGO.Task.cutCoords(e),e=OBJ.get(AGO.Styles.colorType,+e.split(":")[3]||1)||"",a=t||AGO.Panel.GetActive("Target","time")?"autocopy":"coords"),DOM.updateText("ago_menubutton_coords","id",t),DOM.setStyleColor("ago_menubutton_coords","id",e),DOM.updateClass("ago_menubutton_logo","id","ago_menubutton_logo_"+a)},clickButton:function(){AGO.App.disabled?AGO.App.Save({disabled:!1}):AGO.Notify.problem<20&&AGO.Option.Menu()},updateButton:function(){5<AGO.Init.status&&DOM.setStyleColor("ago_menubutton","id",AGO.Notify.color||"")},updateInfo:function(e,t,a){var n;if(5<AGO.Init.status&&e){var o,i;if(AGO.Main.statusInfo=2,!(n=document.getElementById("ago_menubutton_info")))(o=document.getElementById("ago_menubutton"))?((i=document.createElement("li")).className="ago_menubutton_info",(n=i.appendChild(document.createElement("div"))).id="ago_menubutton_info",DOM.after(o.parentNode,i)):n=void 0;n&&(DOM.hasChildren(n)||(n.parentNode.style.display="list-item",window.setTimeout(AGO.Main.hideInfo,AGO.Notify.loading?4e3:2e3)),e=document.getElementById("ago_menubutton_info_"+e)||DOM.append(n,"span",{id:"ago_menubutton_info_"+e},{display:"block"}),DOM.updateText(e,null,t),DOM.updateStyle(e,null,"color",a))}},hideInfo:function(){var e;AGO.Main.statusInfo=Math.max(AGO.Main.statusInfo-1,0),AGO.Main.statusInfo?window.setTimeout(AGO.Main.hideInfo,AGO.Notify.loading?4e3:2e3):(AGO.Notify.set("Hide"),(e=document.getElementById("ago_menubutton_info"))&&(DOM.removeChildren(e),DOM.setStyleDisplay(e.parentNode)))},clickIcon:function(){AGO.Option.set("I83",!AGO.Option.is("I83"),1),AGO.Init.Messages("Main","Display"),AGO.Init.Messages("Panel","Display")},updateTitle:function(){var e,t;0<AGO.Main.modeTitle&&(DOM.getProperty("eventboxBlank","id","offsetHeight",2)?(document.title=AGO.App.title,AGO.Main.modeTitle--):(e=DOM.getText("tempcounter","id"),t=DOM.getText("eventContent","id"),e&&t&&(document.title=AGO.App.title+" - "+e+" - "+t)))},Check:function(){},addVersionCheck:function(e){var t,a,n,o;n=NMR.parseVersion(AGO.App.versionOGameMax)>=NMR.parseVersion(AGO.App.versionOGame),(t=document.getElementById("oGameVersionCheckData"))||(e=e.appendChild(document.createElement("li")),t=DOM.appendDIV(e,{id:"oGameVersionCheckData"},{display:"none"}),a=DOM.appendA(e,{id:"oGameVersionCheckMenuButton",class:"menubutton"},{click:AGO.Main.clickVersionCheck}),o={BA:"Skripte",CZ:"Skripty",GR:"Σενάρια",HU:"Szkriptek",JP:"スクリプト",NO:"Skript",PL:"Skrypty",RO:"Scripturi",RU:"сценарии",SE:"Skript",SI:"Skripti",SK:"Skripty",TR:"Scriptler",TW:"脚本"}[AGO.Uni.lang]||"Scripts",DOM.appendSPAN(a,"textlabel",o),n&&AGO.Option.is("O02")&&DOM.setStyleDisplay(e)),e=document.createElement("span"),DOM.appendSPAN(e,"","AntiGameOrigin"),DOM.appendSPAN(e,"",AGO.App.versionOGameMax),DOM.appendSPAN(e,"","http://antigame.de/home.php?page=home"),DOM.appendSPAN(e,"",n),DOM.appendChild(t,e),(a=a||document.getElementById("oGameVersionCheckMenuButton"))&&!n&&(t=6,window.localStorage&&(n=window.localStorage.getItem("OGameVersionCheck")||"",t=parseInt(n.split("|")[1],10)||0,n.split("|")[0]!==AGO.ogameVersion&&(t=0)),t<6&&"#FF4B00"!==a.style.color&&(window.localStorage&&window.localStorage.setItem("OGameVersionCheck",AGO.App.versionOGame+"|"+(t+1)),a.style.color="#FF4B00"))},checkVersionCheck:function(){var e,t;(e=document.getElementById("oGameVersionCheckData"))&&AGO.Option.is("O02")&&(DOM.iterateChildren(e,function(e){"true"!==DOM.getText(DOM.getChildren(e,3))&&(t=!0)}),DOM.setStyleDisplay(e.parentNode,null,t?"list-item":"none"))},clickVersionCheck:function(){var e,t,a,n,o,i,l;if(e=document.getElementById("contentWrapper"),t=document.getElementById("oGameVersionCheck"),o=document.getElementById("oGameVersionCheckData"),e)if(DOM.setStyleDisplay("inhalt","id",t?"block":"none"),t)e.removeChild(t);else{if(n=(t=document.querySelector("#oGameVersionCheckMenuButton span"))?t.textContent:"",t=DOM.appendDIV(null,{id:"oGameVersionCheck"}),a=DOM.appendDIV(t,null,{background:'url("http://gf1.geo.gfsrv.net/cdn63/10e31cd5234445e4084558ea3506ea.gif") no-repeat scroll 0px 0px transparent',height:"28px",marginTop:"8px",position:"relative",textAlign:"center"}),DOM.appendDIV(a,null,{font:"700 12px/23px Verdana,Arial,Helvetica,sans-serif",color:"rgb(111, 159, 200)",paddingTop:"3px"}).textContent=n,a=DOM.appendDIV(t,null,{background:'url("http://gf1.geo.gfsrv.net/cdn9e/4f73643e86a952be4aed7fdd61805a.gif") repeat-y scroll 5px 0px transparent',color:"rgb(132, 132, 132)",margin:"0px",padding:"17px 0px 10px",width:"100%",textAlign:"center"}),o)for(l=0;l<o.childNodes.length;l++)i=o.childNodes[l].childNodes[2].textContent,n=DOM.append(a,"p",null,{padding:"3px 0px",color:"true"===o.childNodes[l].childNodes[3].textContent?"#008000":"#FF4B00"}),DOM.appendTEXT(n,o.childNodes[l].childNodes[0].textContent),DOM.appendA(n,{href:i,target:"_blank"}).textContent=" ( link ) ";DOM.appendDIV(t,null,{background:'url("http://gf1.geo.gfsrv.net/cdn30/aa3e8edec0a2681915b3c9c6795e6f.gif") no-repeat scroll 2px 0px transparent',height:"17px"}),DOM.prependChild(e,t)}}},AGO.Planets={status:0,updateDisplayStatus:0,Data:{},ByIndex:[],ByCoords:{},ByCoordstype:{},Task:{},Messages:function(e,t){"Action"===e?AGO.Planets.Action(t):"Display"===e&&AGO.Planets.Display()},Timer:function(){0<AGO.Planets.updateDisplayStatus&&AGO.Planets.Display()},onSwipe:function(e){"left"===e?AGO.Planets.Action({mode:"set",type:1}):"right"===e?AGO.Planets.Action({mode:"set",type:3}):VAL.check(e,"up","down")&&AGO.Planets.Action({scroll:e})},Read:function(){var e,t,a,n,o,i,l,s=0;if(e=document.getElementById("planetList"),t=DOM.getText("#countColonies .textCenter span").split("/"),AGO.Planets.count=NMR.parseIntAbs(t[0]),AGO.Planets.possible=NMR.parseIntAbs(t[1]),e&&DOM.hasChildren(e)>=AGO.Planets.count){for(AGO.Planets.status=1,e=e.firstChild;e;e=e.nextSibling)if(1===e.nodeType&&(l=STR.check(NMR.parseIntAbs(e.id)))){for(n={index:++s,type:1},o={index:s,type:3,planet:l},t=e.firstChild;t;t=t.nextSibling)if(1===t.nodeType)if(-1<(i=t.className||"").indexOf("planetlink"))for(i=t.title||"",n.name=(i.split("[",1)[0].split("<b>",2)[1]||"").trim(),n.temp=NMR.parseInt((i.match(/<br>.*<br>[^\d\-]*([\d\-]+)/i)||[])[1]),a=t.firstChild;a;a=a.nextSibling)1===a.nodeType&&(-1<(i=a.className||"").indexOf("planetPic")?n.img=a.src:-1<i.indexOf("planet-koords")&&(n.coords=(a.textContent||"").replace(/[^\d\:]/g,"")));else if(-1<i.indexOf("moonlink"))for(i=t.title||"",n.moon=STR.check(NMR.parseIntAbs(STR.getParameter("cp",t.href))),o.name=(i.split("[",1)[0].split("<b>",2)[1]||"").trim(),a=t.firstChild;a;a=a.nextSibling)1===a.nodeType&&(-1<(i=a.className||"").indexOf("icon-moon")&&(o.img=a.src));else-1<i.indexOf("constructionIcon")&&(a=t.querySelector(".icon_wrench_red")?-1:1,-1<i.indexOf("moon")?o.construction=a:n.construction=a);n.coords&&(n.coordstype=n.coords+":1",AGO.Planets.Data[l]=n,AGO.Planets.ByCoords[n.coords]=l,AGO.Planets.ByIndex[n.index]=l,AGO.Planets.ByCoordstype[n.coordstype]=l,n.moon&&(o.coords=n.coords,o.coordstype=n.coords+":3",AGO.Planets.Data[n.moon]=o,AGO.Planets.ByCoordstype[o.coordstype]=n.moon))}}else AGO.Planets.status=0,AGO.Planets.count&&AGB.Log("Planets - Error - Something wrong with the planetlist !",!0)},Run:function(){var e,n,o;n=AGO.Option.is("O53"),o=AGO.Option.isAnd("U32","O54"),(e=document.getElementById("rechts"))&&AGO.Option.is("O50")&&(AGO.Planets.enabled=!0,AGO.Planets.improve=AGO.Option.is("O51"),AGO.Planets.coloring=AGO.Option.isAnd("CS0","O55"),AGO.Option.is("O52")&&DOM.extendClass(e,null,"ago_planets_shrink"),e=document.createDocumentFragment(),DOM.appendSPAN(e,"ago_planets_arrow_planet"),DOM.appendSPAN(e,"ago_planets_arrow_moon"),DOM.appendChild(document.getElementById("countColonies"),e),DOM.iterateChildren(document.getElementById("planetList"),function(e){var t,a;DOM.setAttribute(".activity img",e,"src","/cdn/img/galaxy/activity15.gif"),a=STR.check(NMR.parseIntAbs(e.id)),AGO.Planets.Data[a]&&(AGO.Planets.coloring&&AGO.Acc.coords===AGO.Planets.Data[a].coords&&DOM.extendClass(e,null,AGO.Token.getClassHighlight(AGO.Acc.type)),o&&DOM.appendSPAN(e,"ago_planets_shortcut",AGO.Planets.Data[a].index),n&&(AGO.Planets.Data[a].construction&&(t=(e.querySelector(".constructionIcon:not(.moon)")||{}).title,DOM.appendSPAN(e,"ago_planets_construction",t)),AGO.Planets.Data[a].moon&&AGO.Planets.Data[AGO.Planets.Data[a].moon].construction&&(t=(e.querySelector(".constructionIcon.moon")||{}).title,DOM.appendSPAN(e,"ago_planets_construction_moon",t))))}),AGO.Planets.coloring&&DOM.addEvents("rechts","id",{click:AGO.Planets.click,mouseover:AGO.Planets.hover,mouseout:AGO.Planets.hover}),DOM.addEvents("countColonies","id",{click:AGO.Planets.clickArrow}),AGO.Planets.Display(!0)),e=e=null},Display:function(e){var a,n,o,i,l;(a=document.getElementById("planetList"))&&((e||0<AGO.Planets.updateDisplayStatus)&&(AGO.Planets.updateDisplayStatus--,AGO.Planets.iterate(3,function(e,t){(o=AGO.Fleet.Get("Cooldown",t,2))&&(0<=(o=3600/AGO.Uni.speedFleet-(AGO.Time.timestamp()-Math.max(o,1e4)))?(AGO.Planets.updateDisplayStatus=5,i="ago_planets_cooldown"+(o<=60?" ago_planets_cooldown_seconds":""),l=60<o?Math.ceil(o/60):Math.floor(o)||"",(n=a.querySelector("#planet-"+e.planet+" .ago_planets_cooldown"))?(DOM.updateText(n,null,l),DOM.updateClass(n,null,i)):(n=a.querySelector("#planet-"+e.planet+" .moonlink"))&&DOM.appendSPAN(n,i,l)):AGO.Fleet.Get("Cooldown",t,0,2))})),AGO.Planets.coloring&&AGO.Planets.Task.coords&&AGO.Planets.Task.coordstype!==AGO.Planets.Task.coords+":"+AGO.Planets.Task.type&&DOM.iterateChildren(a,function(e){var t,a;(t=STR.check(NMR.parseIntAbs(e.id)))&&AGO.Planets.Data[t]&&AGO.Planets.Data[t].coords===AGO.Planets.Task.coords&&(3!==AGO.Planets.Task.type||AGO.Planets.Data[t].moon||(AGO.Planets.Task.type=1),a=AGO.Token.getClassSelected(AGO.Planets.Task.type)),DOM.setClassGroup(e,null,"ago_selected",a)})),a=n=null},Get:function(e,t,a){return t=(e=AGO.Planets.GetId(e))&&AGO.Planets.Data[e]&&t?AGO.Planets.Data[e][t]:"",6===a?STR.check(t):+t||0},GetByCoords:function(e,t,a){return AGO.Planets.Get(AGO.Planets.ByCoords[e],t,a)},GetByIndex:function(e,t,a){return AGO.Planets.Get(AGO.Planets.ByIndex[e],t,a)},GetId:function(e){return e&&AGO.Planets.Data[e]?e:"active"===e?AGO.Acc.planetId:AGO.Planets.ByCoordstype[e]||""},getHome:function(){var a;return AGO.Planets.iterate(1,function(e,t){(!a||+t<a)&&(a=+t)}),a},owncoords:function(e,t){return AGO.Planets.ByCoords[e]?e===AGO.Acc.coords?t===AGO.Acc.type?4:AGO.Planets.ByCoordstype[e+":"+t]?3:1:AGO.Planets.ByCoordstype[e+":"+t]?2:1:0},click:function(e){var t;e&&e.target&&(e="A"===e.target.nodeName?e.target:"A"===e.target.parentNode.nodeName?e.target.parentNode:null)&&(t=-1<(e.className||"").indexOf("moon")?3:1,DOM.removeClassGroup(e.parentNode,null,"ago_highlight"),DOM.extendClass(e.parentNode,null,AGO.Token.getClassHighlight(t,"active")))},clickArrow:function(e){e&&e.target&&(e=DOM.hasClass(e.target,null,"ago_planets_arrow_moon")?3:DOM.hasClass(e.target,null,"ago_planets_arrow_planet")?1:0)&&AGO.Planets.Action({scroll:"down",type:e})},hover:function(e){var t;e&&e.target&&(t="A"===e.target.nodeName?e.target:"A"===e.target.parentNode.nodeName?e.target.parentNode:null)&&(e="mouseover"===e.type&&-1<(t.className||"").indexOf("moon")?"ago_hover_S3":"ago_hover_S1",DOM.setClassGroup(t.parentNode,null,"ago_hover",e))},Action:function(e){var t,a,n;if(OBJ.is(e)){if(t=a=AGO.Planets.Get("active","index"),e.scroll){e.type=e.type||AGO.Acc.type,e.mode="set";do{if("down"===e.scroll?++t>=AGO.Planets.ByIndex.length&&(t=1):--t<1&&(t=AGO.Planets.ByIndex.length-1),1===e.type)break;if(n=AGO.Planets.ByIndex[t],AGO.Planets.Data[n].moon)break}while(t!==a)}"set"===e.mode?(t=document.querySelectorAll("#planetList .smallplanet a.planetlink")[t-1])&&DOM.click(1===e.type?"a.planetlink":"a.moonlink",t.parentNode):"select"===e.mode&&AGO.Planets.coloring&&(AGO.Planets.Task.coords=e.coords,AGO.Planets.Task.type=e.type,AGO.Planets.Display())}},iterate:function(e,t){var a,n;for(n=1;n<AGO.Planets.ByIndex.length;n++)a=AGO.Planets.ByIndex[n],AGO.Planets.Data[a]&&(e&&1!==e||t(AGO.Planets.Data[a],a),!(a=AGO.Planets.Data[a].moon)||e&&3!==e||t(AGO.Planets.Data[a],a))}},AGO.Panel={displayStatus:0,mouseStatus:!1,mouseCount:0,Data:{},Messages:function(e,t){"Display"===e?AGO.Panel.Display(t):"updateTab"===e?AGO.Panel.updateTab(t):"Action"===e?AGO.Panel.Action(t):"hover"===e&&AGO.Panel.hoverExtern(t)},Timer:function(){},Init:function(e,t){AGO.Panel.Data=OBJ.is(e)?e:{},t&&(AGO.Panel.Display(),window.setTimeout(function(){var e;e=AGO.Background.Get("Panel_Target",6).split("|"),AGO.Background.Set("Panel_Target",""),AGO.Option.is("I81")&&(e[0]||e[1])&&AGO.Init.Messages("Token","Action",{action:"set",tab:"Target",token:81,coords:e[0],time:e[1],marked:1})},200))},Run:function(){AGO.Option.is("I00")&&(AGO.Panel.enabled=!0,AGO.Panel.place=Math.ceil(Math.max((+document.body.clientWidth||0)-1e3,2)/2),AGO.Option.is("I03")?(AGO.Panel.width=Math.min(AGO.Option.get("I03",2),AGO.Panel.place+190),AGO.Panel.space=NMR.minMax(Math.ceil((AGO.Panel.place-AGO.Panel.width)/2),3,40)):(AGO.Panel.space=NMR.minMax(Math.ceil((AGO.Panel.place-220)/3),3,40),AGO.Panel.width=NMR.minMax(AGO.Panel.place-4-2*AGO.Panel.space,190,290)),AGO.Panel.innerWidth=AGO.Panel.width-8,AGO.Panel.left=-(AGO.Panel.width+AGO.Panel.space+4),AGO.Panel.slideLeft=-(AGO.Panel.place-1),AGO.Panel.height=NMR.minMax(AGO.Option.get("I04",2)||(+window.innerHeight||0)-(AGO.Option.is("commander")?55:90),400,1200),AGO.Option.is("T00")||AGO.Panel.set("Tools","label",""),AGO.Panel.Show()),AGO.Box.Run()},onSwipe:function(e){"left"===e&&window.setTimeout(function(){AGO.Panel.panelInactive(!0)},333),"right"===e&&AGO.Panel.panelActive(3)},Show:function(){var e,t,a,n,o,i;(e=document.getElementById("box"))&&(t=document.createDocumentFragment(),a=(AGO.Panel.left<AGO.Panel.slideLeft?"ago_panel_slide ":"")+(OBJ.get(AGO.Styles.classVisible,AGO.Option.get("I02",2))||""),a=DOM.appendDIV(t,{class:a,id:"ago_panel_button"}),DOM.appendSPAN(a,"ago_panel_arrow"),i=DOM.appendDIV(t,{id:"ago_panel"},{left:AGO.Panel.left+"px"}),n=DOM.appendDIV(i,{class:"ago_panel_wrapper"},{width:AGO.Panel.width+"px",minHeight:AGO.Panel.height+"px"}),DOM.appendSPAN(n,"ago_panel_arrow"),OBJ.iterate(AGO.Panel.Data,function(e){AGO.Panel.Get(e,"label",6)&&(o=DOM.appendDIV(n,{id:"ago_panel_"+e}),(i=DOM.appendDIV(o,{class:"ago_panel_tab","ago-data":JSON.stringify({update:{tab:e,status:"toggle"}})})).textContent=AGO.Label.get(AGO.Panel.Get(e,"label",6)),DOM.appendSPAN(i,"ago_panel_tab_info"),DOM.appendDIV(o,"ago_panel_tab_header"),DOM.appendDIV(o,"ago_panel_tab_content"),DOM.appendDIV(o,"ago_panel_tab_footer"),AGO.Panel.Get(e,"status"))&&("Settings"===e?AGO.Panel.createSettings(o,e,""):AGO.Panel["create"+e](o,e,AGO.Panel.Get(e,"data",6),AGO.Panel.Data.Cache),DOM.updateClass(o,null,"ago_panel_tab_open"))}),DOM.appendSPAN(n,"ago_panel_arrow"),e.appendChild(t),AGO.Panel.updateTab(),DOM.addEventsAll("#ago_panel_button, #ago_panel .ago_panel_wrapper",null,{click:AGO.Panel.click,mouseover:AGO.Panel.hover,mouseout:AGO.Panel.hover})),e=t=a=n=o=i=null},set:function(e,t,a,n){e&&t&&AGO.Panel.Data[e]&&(AGO.Panel.Data[e][t]=a,n||AGB.message("Panel","Set",{tab:e,key:t,value:a}))},Get:function(e,t,a){return e=e&&AGO.Panel.Data[e]&&t?AGO.Panel.Data[e][t]:"",6===a?STR.check(e):+e||0},GetActive:function(e,t,a){return e=e&&AGO.Panel.Data[e]?OBJ.get(AGO.Panel.Data[e].active,t):"",6===a?STR.check(e):+e||0},Display:function(e){var a,t;5<AGO.Init.status&&!AGO.Panel.updateDisplayLock&&(AGO.Panel.updateDisplayLock=!0,a=OBJ.parse(e),AGO.Panel.enabled&&!a.tab&&OBJ.iterate(AGO.Panel.Data,function(e){AGO.Panel.Get(e,"label",6)&&"Settings"!==e&&AGO.Panel.Get(e,"status")&&(a.tab=e)}),a.tab&&AGO.Panel.Data[a.tab]&&("Settings"!==a.tab&&("data"in a?AGO.Panel.set(a.tab,"data",a.data):a.data=AGO.Panel.Get(a.tab,"data",6)),t=document.getElementById("ago_panel_"+a.tab),AGO.Panel.enabled&&DOM.getChildren(t,2)&&(a.status="status"in a?"toggle"!==a.status?a.status:AGO.Panel.Get(a.tab,"status")?0:1:1,AGO.Panel.set(a.tab,"status",a.status),OBJ.iterate(AGO.Panel.Data,function(e){var t;AGO.Panel.Get(e,"label",6)&&((t=AGO.Panel.Get(e,"status"))&&"Settings"!==e&&"Settings"!==a.tab&&e!==a.tab&&(t=0,AGO.Panel.set(e,"status",t)),DOM.updateClass("ago_panel_"+e,"id",t?"ago_panel_tab_open":""))}),"Settings"!==a.tab&&AGO.Panel["create"+a.tab](t,a.tab,a.data),e&&AGO.Panel.panelActive(2)),AGO.Panel.Get("Settings","status")&&AGO.Panel.createSettings(document.getElementById("ago_panel_Settings"),a.tab,a.data)),window.setTimeout(function(){AGO.Panel.updateDisplayLock=!1},50))},updateTab:function(e){var t;AGO.Init.status&&((e=OBJ.get(e,"tab"))&&"Flights"!==e||(e=AGO.Fleet.Get("Current","fleets"),(t=AGO.Fleet.Get("Current","fleetsSlots"))&&DOM.updateText("#ago_panel_Flights .ago_panel_tab_info",null,e+"/"+t)))},createSettings:function(e,t,a,n){function o(e,t,a,n,o,i,l,s){var p;p=AGO.Option.get(e,2),t=AGO.Label.get(t||e),a=DOM.appendTR(r,o?"ago_panel_content_disabled":"",{setting:{id:e},update:a,message:n}),DOM.appendTD(a,t.length>c/7?{class:"tooltip",title:t}:null,(i?"   ":"• ")+t),t=DOM.appendTD(a),t=DOM.append(t,"input",{type:l||"checkbox"},null,{change:AGO.Panel.changeSetting}),"radio"===l?(t.name="ago_panel_settings_"+e,t.checked=p===s,t.value=s):"text"===l?t.value=p||"":t.checked=Boolean(p)}var r,c,i,l,s,p,d,O,A,u;if(c=AGO.Panel.innerWidth-25,a=document.createDocumentFragment(),r=DOM.appendTABLE(a,"ago_panel_settings",{width:AGO.Panel.innerWidth+"px"},[c,25]),n)switch(t){case"Account":o("I21","I21",{tab:t,data:""},"","","","radio",1),o("I21","I41",{tab:t,data:""},"","","","radio",2),o("I22","",{tab:t},"",2===AGO.Option.get("I21",2));break;case"Flights":o("I41","I21",{tab:t,data:""},"","","","radio",1),o("I41","I41",{tab:t,data:""},"","","","radio",2),o("I42","I22",{tab:t},"",2===AGO.Option.get("I41",2));break;case"Construction":o("I31","",{tab:t}),o("I32","I22",{tab:t}),o("I35","",{tab:t});break;case"Target":o("I82","",{tab:t},{page:"Main",role:"Display"}),o("I83","",{tab:t},{page:"Main",role:"Display"});break;case"Tools":o("T01","",{tab:t}),o("","T05")}else switch(AGO.App.page){case"resources":case"station":case"research":o("B11","",{tab:"Settings"},{page:"Page",role:"Display"}),o("B12","",{tab:"Settings"},{page:"Page",role:"Display"},!AGO.Option.is("B11"),"indent");break;case"shipyard":case"defense":o("B11","",{tab:"Settings"},{page:"Page",role:"Display"});break;case"fleet2":o("F16");break;case"fleet3":o("F18");break;case"movement":o("E14");break;case"messages":o("M51","","",{page:"Page",role:"toggleSpiohelper"}),o("M53"),l=i="M30",s="",p={page:"Page",role:"changeStatus"},d={0:" - ",1:"M31",2:"M32",3:"M33",4:"M34",5:"M35"},u=AGO.Option.get(i,2),l&&(l=AGO.Label.get(l),O=DOM.appendTR(r),A=l.length>c/7?{class:"tooltip",title:l}:null,DOM.appendTD(O,A).innerHTML="&bull;&thinsp;"+l,DOM.appendTD(O)),O=DOM.appendTR(r,"ago_panel_settings_select",{setting:{id:i},update:s,message:p}),i=DOM.appendTD(O,{colspan:2}),DOM.appendSELECT(i,"dropdownInitialized",d,STR.zero(u),{change:AGO.Panel.changeSetting})}DOM.replaceChildren(DOM.getChildren(e,1),a),a=r=null},changeSetting:function(e){var t;e&&e.currentTarget&&(t=DOM.getData(e.currentTarget,null,2),OBJ.is(t.setting)&&(e="checkbox"!==e.currentTarget.type?+e.currentTarget.value||0:e.currentTarget.checked?1:0,AGO.Option.set(t.setting.id,e,2),OBJ.is(t.update)&&AGO.Panel.Display(t.update),OBJ.is(t.message)&&("data"in t.message||(t.message.data=e),AGO.Init.Messages(t.message.page,t.message.role,t.message.data))))},createAccount:function(d,O,A){var e,t;A&&AGO.Option.set("I21",0,2),2===AGO.Option.get("I21",2)?e="account":(e=AGO.Planets.GetId(A)||AGO.Planets.GetId("active"),AGO.Option.is("I22")&&(t=AGO.Planets.Get(e,"moon",6)||AGO.Planets.Get(e,"planet",6))),AGB.message("Panel","ListAccount",{planet:e,moon:t},function(a){var e,n,o,i,t,l,s,p,r,c;a&&a.tab&&(A&&AGO.Option.set("I21",0,2),AGO.Panel.createSettings(d,O,A,"intern"),c="account"===(r=2===AGO.Option.get("I21",2)?"account":AGO.Planets.GetId(A)||AGO.Planets.GetId("active"))?"account":AGO.Planets.Get(r,AGO.Option.is("I22")?"coords":"coordstype",6),e=document.createDocumentFragment(),n=DOM.appendTABLE(e,"ago_panel_overview",{width:AGO.Panel.innerWidth+"px"},[58,AGO.Panel.innerWidth-96,38]),AGO.Planets.iterate(1,function(e,t){p=e.moon,s=t===r?"ago_color_planet":p===r?"ago_color_moon":"",o=DOM.appendTR(n,s,{tab:O,data:e.coordstype}),s=9<=e.coords.length?"ago_panel_overview_coords_small":"ago_panel_overview_coords",DOM.appendTD(o,s,e.coords),DOM.appendTD(o,"ago_panel_overview_name",e.name),i=DOM.appendTD(o,"ago_panel_overview_status"),DOM.appendSPAN(i).style.backgroundColor=a.statusColor[t]||"#6A0A0A",p&&(DOM.setData(i,null,{tab:O,data:AGO.Planets.Data[p].coordstype}),DOM.appendSPAN(i).style.backgroundColor=a.statusColor[p]||"#6A0A0A",DOM.appendIMG(i,AGO.Planets.Data[p].img))}),l=(t=AGO.Events.calculate("ownership"))[c]?t[c].own:null,t=t[c]?t[c].neutral:null,l&&AGO.Option.is("I24")&&(AGO.Task.addResources(a.Units,l),AGO.Task.addShips(a.Units,l)),t&&AGO.Option.is("I26")&&AGO.Task.addResources(a.Units,t),AGO.Panel.appendUnits(e,a.Units,"I27",!0,O,3,2),AGO.Panel.appendUnits(e,l,"I24","I24",O,2,1,"ago_color_own"),AGO.Panel.appendUnits(e,t,"I26","I26",O,1,0,"ago_color_neutral"),DOM.replaceChildren(DOM.getChildren(d,2),e),e=n=o=i=null)})},appendUnits:function(e,t,a,n,o,i,l,s){function p(e,t,a,n,o){return e=DOM.appendLI(c,t,a,10),0<o?DOM.appendSPAN(e,"ago_panel_content_value",n,3):(a=o<0?"I0E":"I0A",DOM.appendSPAN(e,{class:"tooltip ago_panel_content_value ago_panel_content_unavailable",title:AGO.Label.get("I0B")},a,10)),e}function r(e,t,a,n){for(var o in a)(t[o]||n)&&(a=DOM.appendLI(e,"",o,11),DOM.appendSPAN(a,"ago_panel_content_value",t[o],2))}var c,d,O,A;t&&(A="string"==typeof n?AGO.Option.is(n):n,(c=document.createElement("ul")).className="ago_panel_content",O=A?"ago_panel_content_header":"ago_panel_content_header ago_panel_content_disabled",O=s?O+" "+s:O,i&&(2<=i||t.resources||t.timeShip)&&(d=p(c,O,a,t.resources,t.timeResource),"string"==typeof n&&(DOM.setData(d,null,{setting:{id:n},update:{tab:o}}),DOM.append(d,"input",{type:"checkbox"},{display:"none"},{change:AGO.Panel.changeSetting},{checked:Boolean(A)})),A&&t.timeResource&&(3<=i||t.resources)&&r(c,t,AGO.Item.Resource,3<=i)),l&&A&&((2<=l||t.shipsCivil)&&(d=p(c,O,"I28",t.shipsCivil,t.timeShip),t.shipsCivil&&r(c,t,AGO.Item.ShipCivil)),(2<=l||t.shipsCombat)&&(d=p(c,O,"I29",t.shipsCombat,t.timeShip),t.shipsCombat&&r(c,t,AGO.Item.ShipCombat))),d&&e.appendChild(c)),c=d=null},createFlights:function(e,t,a){function n(e,t,a){DOM.appendSPAN(e,OBJ.get(AGO.Styles.classFleet,a),t&&t.fleets?t.fleets:"  ")}var o,i,l,s,p,r,c,d,O,A;a&&AGO.Option.set("I41",0,2),AGO.Panel.createSettings(e,t,a,"intern"),o=document.createDocumentFragment(),i=DOM.appendTABLE(o,"ago_panel_overview",{width:AGO.Panel.innerWidth+"px"},[58,AGO.Panel.innerWidth-130,72]),(r=AGO.Events.calculate("flights")).account?(A=2!==AGO.Option.get("I41",2)&&AGO.Option.is("I42"),a=r[a]?a:"",O=2===AGO.Option.get("I41",2)?"account":AGO.Planets.Get(a||"active","coordstype",6)||a,d="account"===O?"account":A?AGO.Task.cutCoords(O):O,AGO.Planets.iterate(0,function(e){(p=r[e.coordstype])&&(c=d===e.coords||O===e.coordstype?HTML.classType(e.type):"",l=DOM.appendTR(i,c,{tab:t,data:e.coordstype}),c=9<=e.coords.length?"ago_panel_overview_coords_small":"ago_panel_overview_coords",s=DOM.appendTD(l,c,e.coords),c=O===e.coordstype?"ago_panel_overview_name":"ago_panel_overview_name ago_color_normal",s=DOM.appendTD(l,c),3===e.type&&DOM.appendIMG(s,e.img,"11px"),DOM.appendTEXT(s,e.name),n(s=DOM.appendTD(l,"ago_panel_fleets"),p.hostile,1),n(s,p.neutral,2),n(s,p.back,4),n(s,p.own,3))}),d&&r[d]&&(("account"===d||A)&&(l=DOM.append(o,"ul","ago_panel_content"),s=DOM.appendLI(l,"ago_panel_content_header","I47",10),n(a=DOM.appendSPAN(s,"ago_panel_content_value ago_panel_fleets"),r[d].hostile,1),n(a,r[d].neutral,2),n(a,r[d].back,4),n(a,r[d].own,3),n(a,r[d].friend,5),n(a,r[d].enemy,6)),AGO.Panel.appendUnits(o,r[d].own,"I24",!0,t,2,1,"ago_color_own"),AGO.Panel.appendUnits(o,r[d].back,"I25",!0,t,2,1,"ago_color_reverse"),AGO.Panel.appendUnits(o,r[d].neutral,"I26",!0,t,1,1,"ago_color_neutral"),AGO.Panel.appendUnits(o,r[d].hostile,"I26",!0,t,0,1,"ago_color_hostile"))):(l=DOM.appendTR(i),(s=DOM.appendTD(l,{colspan:3})).style.textAlign="right",DOM.appendSPAN(s,{class:"tooltip ago_panel_content_unavailable",title:AGO.Label.get("I0D")},"I0C",10)),DOM.replaceChildren(DOM.getChildren(e,2),o),o=i=l=s=a=null},createConstruction:function(u,g,G,e){function D(e){var t;return t=Math.max(e.level+e.increase,e.id<200?0:1),(e=VAL.status(e.increase,-1*e.range,0,e.range))?t+"-"+(t+e):t||"0"}function m(e,t,a,n,o,i,l,s){var p,r,c;for(r in c={metal:0,crystal:0,deuterium:0,resources:0},AGO.Item.Resource)(0<h[r]||!h.resources)&&(c[r]=t&&+t[r]||0,c.resources+=c[r]);if((o||c.resources)&&(o="string"==typeof n?AGO.Option.is(n):n,a&&(p=o?"ago_panel_content_header":"ago_panel_content_header ago_panel_content_disabled",a=DOM.appendLI(e,s?p+" "+s:p,a,10),s=t&&t.timeResource?DOM.appendSPAN(a,"ago_panel_content_value",c.resources,3):DOM.appendSPAN(a,{class:"tooltip ago_panel_content_value ago_panel_content_unavailable",title:AGO.Label.get("I0B")},"I0A",10),"string"==typeof n&&(DOM.setData(a,null,{setting:{id:n},update:{tab:"Construction"}}),DOM.append(s,"input",{type:"checkbox"},{display:"none"},{change:AGO.Panel.changeSetting},{checked:Boolean(o)}))),c&&c.resources&&o&&t.timeResource))for(r in AGO.Item.Resource)c[r]&&(o&&i&&(v[r]=Math.max(v[r]-(c[r]||0),0)),p=o?"":"ago_panel_content_disabled",a=DOM.appendLI(e,p,r,11),p=l?0<v[r]?"ago_panel_content_value ago_color_palered":"ago_panel_content_value ago_color_lightgreen":"ago_panel_content_value",DOM.appendSPAN(a,p,c[r],2))}var _,v,M,h,y,P,f,b,T;AGO.Panel.createSettings(u,g,"","intern"),h={metal:0,crystal:0,deuterium:0,resources:0,count:0},AGO.Task.updateCoordsType(h,G),y=OBJ.create(h),(M=OBJ.create(h)).routine=2,b=AGO.Option.is("I31"),T=AGO.Option.is("I35"),P=h.coordstype,f=AGO.Option.is("I32")?h.coords:P,e={active:AGO.Acc.planetId},T?e.planet="account":(e.planet=AGO.Planets.GetId(P),AGO.Option.is("I32")&&(e.moon=AGO.Planets.Get(e.planet,"moon",6)||AGO.Planets.Get(e.planet,"planet",6))),AGB.message("Construction","List",e,function(e){var t,a,n,o,i,l,s,p,r,c,d,O,A;A=(e=e||{}).list||{},t=document.createDocumentFragment(),a=DOM.appendTABLE(t,"ago_panel_overview",{width:AGO.Panel.innerWidth+"px"},[58,AGO.Panel.innerWidth-96,38]),AGO.Planets.iterate(0,function(e){if(d=e.coordstype,OBJ.is(A[d]))for(O=0;O<A[d].length;O++)r="",(s=A[d][O])&&(f!==e.coords&&P!==e.coordstype||(G===e.coordstype+":"+O&&(s.selected=1,OBJ.copy({id:s.id,level:s.level,increase:s.increase,range:s.range,reserved:s.reserved},h)),OBJ.iterate(AGO.Item.Resource,function(e){s[e]&&(s.reserved?(y[e]+=s[e],s.selected&&!b&&(h[e]=s[e])):(s.selected||b)&&(h[e]+=s[e]))}),r=s.reserved?"ago_color_reserved":"",(s.selected||b)&&(h.count++,r=r||HTML.classType(e.type))),n=DOM.appendTR(a,r,{tab:g,data:e.coordstype+":"+O}),o=DOM.appendTD(n,"ago_panel_overview_coords",e.coords),r=s.selected?"ago_panel_overview_name":"ago_panel_overview_name ago_color_normal",o=DOM.appendTD(n,r),3===e.type&&DOM.appendIMG(o,HTML.urlTypeIcon(3),"11px"),DOM.appendTEXT(o,s.id,11),r=s.id<200?"ago_panel_overview_count "+HTML.classStatus(s.increase):"ago_panel_overview_count ago_color_normal",o=DOM.appendTD(n,r),s.reserved&&(c=s.increase<0?"icon_reserved_red.gif":"icon_reserved.gif",DOM.appendIMG(o,HTML.urlImage(c),"11px")),DOM.appendTEXT(o,D(s)))}),h.count&&(AGO.Task.updateResources(h),AGO.Task.updateResources(y),v=OBJ.create(h),a=DOM.append(t,"ul","ago_panel_content"),r=h.reserved?"ago_panel_content_action ago_panel_content_reserved":"ago_panel_content_action",n=DOM.appendLI(a,r),r=h.increase<0?"ago_icon_reserved_red":"ago_icon_reserved",DOM.appendA(n,r,null,{action:{action:"reserve",tab:g,value:G}}),DOM.appendA(n,"icon icon_skip_back",null,{action:{action:"decreaseRange",tab:g,value:G}}),DOM.appendA(n,"icon icon_rewind",null,{action:{action:"decrease",tab:g,value:G}}),r=h.id<200?HTML.classStatus(h.increase):"ago_color_normal",DOM.appendSPAN(n,r,D(h)),DOM.appendA(n,"icon icon_fastforward",null,{action:{action:"increase",tab:g,value:G}}),DOM.appendA(n,"icon icon_skip",null,{action:{action:"increaseRange",tab:g,value:G}}),DOM.appendA(n,"icon icon_delete",null,{action:{action:"remove",tab:g,value:G}}),p=1<h.count?"I3B":h.reserved?"I37":"I3A",m(a,h,p,!0,"always"),T&&(a=DOM.append(t,"ul","ago_panel_content"),DOM.appendLI(a,"ago_panel_content_action","Account")),l=e.Units||{},m(a,l,"I23","I33","always","reduce","colorize","ago_color_stationed"),_=AGO.Events.calculate("ownership"),(l=_[d=T?"account":f]&&OBJ.is(_[d].own)?_[d].own:{}).timeResource=_.account?1:0,m(a,l,"I24","I34","","reduce","colorize","ago_color_own"),(l=_[d]&&OBJ.is(_[d].neutral)?_[d].neutral:{}).timeResource=_.account?1:0,m(a,l,"I26","I36","","reduce","colorize","ago_color_neutral"),m(a,y,"I37","I37","","reduce","colorize","ago_color_reserved"),P===AGO.Acc.coordstype||T||(a=DOM.append(t,"ul","ago_panel_content"),l=e.Active||{},AGO.Option.is("I38")&&(M.mode=!0,OBJ.iterate(AGO.Item.Resource,function(e){M[e]=Math.max(Math.min(v[e],l[e]),0),M.resources+=M[e]})),m(a,l,"I38","I38","always","reduce","colorize"),r=M.mode?"ago_panel_content_header":"ago_panel_content_header ago_panel_content_disabled",n=DOM.appendLI(a,r),c=AGO.Uni.path+"fleet1",OBJ.iterateFilter(M,function(e){c+=STR.addParameter(e,M[e])},"galaxy system position type metal crystal deuterium routine".split(" ")),i=DOM.appendA(n,{class:"btn_blue",href:c},null,null,!M.mode),DOM.appendTEXT(i,"F60",10),DOM.appendSPAN(n,"ago_panel_content_value",M.resources,2),m(a,M,"",M.mode,"always","","colorize")),b&&h.resources||!h.reserved)&&(m(a=DOM.append(t,"ul","ago_panel_content"),v,"I39",!0,"always","","colorize"),AGO.Task.updateResources(v),v.resources&&(DOM.appendLI(a),l={202:0,203:0,209:0,214:0},OBJ.iterate(l,function(e){(s={action:10})[e]=Math.ceil(v.resources/AGO.Item[e].capacity),n=DOM.appendLI(a,{"ago-data":JSON.stringify({message:{page:["Fleet1"],role:"Action",data:s}})},e,11),i=DOM.appendSPAN(n,"ago_panel_content_value",s[e],2)}))),DOM.replaceChildren(DOM.getChildren(u,2),t),t=a=n=o=i=null})},createAlliance:function(o,e,t,a){function n(e){var t,a,n;e&&e.tab&&(n=AGO.Panel.GetActive("Alliance","id",6),t=document.createDocumentFragment(),a=AGO.Panel.appendTable(t),AGO.Panel.appendToken(a,"Alliance",e.token,e.listTab),a=AGO.Panel.appendTable(t),AGO.Panel.appendAlliance(a,"Alliance",e.token,n,e.listToken),DOM.replaceChildren(DOM.getChildren(o,2),t))}OBJ.get(a,"tab")===e?n(a):AGB.message("Token","List",{tab:e,token:+t||0},n)},createPlayer:function(o,e,t,a){function n(e){var t,a,n;e&&e.tab&&(n=AGO.Panel.GetActive("Player","id",6),t=document.createDocumentFragment(),a=AGO.Panel.appendTable(t),AGO.Panel.appendToken(a,e.tab,e.token,e.listTab),a=AGO.Panel.appendTable(t),AGO.Panel.appendPlayer(a,e.token,n,e.listToken),DOM.replaceChildren(DOM.getChildren(o,2),t))}"Player"===OBJ.get(a,"tab")?n(a):AGB.message("Token","List",{tab:"Player",token:AGO.Panel.Get("Player","data")},n)},createTarget:function(o,e,t,a){function n(e){var t,a,n;e&&e.tab&&(n=AGO.Panel.GetActive("Target","id",6),t=document.createDocumentFragment(),a=AGO.Panel.appendTable(t),AGO.Panel.appendToken(a,"Target",e.token,e.listTab),a=AGO.Panel.appendTable(t),AGO.Panel.appendTarget(a,e.token,n,e.listToken),DOM.replaceChildren(DOM.getChildren(o,2),t))}var i,l,s;AGO.Panel.createSettings(o,e,"","intern"),(i=DOM.getChildren(o,3))&&0===DOM.hasChildren(i)&&(l=DOM.appendTABLE(null,"ago_panel_settings",{width:AGO.Panel.innerWidth+"px"}),s=DOM.appendTR(l),s=DOM.appendTD(s),DOM.append(s,"textarea",{id:"ago_panel_textparser",class:"markItUpEditor"},null,{dblclick:AGO.Panel.parseTarget,blur:AGO.Panel.parseTarget}),i.appendChild(l)),OBJ.get(a,"tab")===e?n(a):AGB.message("Token","List",{tab:e,token:+t||0,sort:AGO.Option.get("I84")},n)},appendToken:function(n,o,i,l){var s;OBJ.iterate(l,function(e){var t,a;80<e&&!s&&(s=!0,t=DOM.appendTR(n,{colspan:3}),DOM.append(t,"TD",null,{height:"10px",lineHeight:"10px"})),0<l[e]&&(a=+e===i?HTML.classType(1):"",t={tab:o,data:e},t=DOM.appendTR(n,a,t),DOM.appendTD(t,"ago_panel_overview_coords"),DOM.appendTD(t,"ago_panel_overview_name "+AGO.Token.getClass(e),AGO.Token.getLabel(e)),DOM.appendTD(t,"ago_panel_overview_count",Math.max(l[e],0)))}),DOM.hasChildren(n)<2&&DOM.setStyleDisplay(n)},appendAlliance:function(n,o,i,l,e){var t;t=DOM.appendTR(n),DOM.appendTD(t,"ago_panel_overview_coords"),DOM.appendTD(t,"ago_panel_overview_name","∇"),t=DOM.appendTD(t,"ago_panel_overview_count"),DOM.appendA(t,"icon icon_delete","",{action:{action:"icon",tab:"Alliance",icon:"remove"}}),OBJ.iterateArray(e,function(e){var t,a;OBJ.is(e)&&(a=l===e.id?HTML.classType(1):"",t={action:{action:"toggle",tab:o,token:i,id:e.id}},t=DOM.appendTR(n,a,t),DOM.appendTD(t,"ago_panel_overview_coords"),DOM.appendTD(t,"ago_panel_overview_name",e.name||e.id),a=DOM.appendTD(t,"ago_panel_overview_count"),"remove"===AGO.Panel.Get("Alliance","icon",6)&&(t={message:{page:"Token",role:"Action",data:{action:"remove",tab:"Alliance",token:i,id:e.id}}},DOM.appendA(a,"icon icon_delete","",t)))}),DOM.hasChildren(n)<2&&DOM.setStyleDisplay(n)},appendPlayer:function(n,o,i,e){var t;t=DOM.appendTR(n),DOM.appendTD(t,"ago_panel_overview_coords"),DOM.appendTD(t,"ago_panel_overview_name","∇"),t=DOM.appendTD(t,"ago_panel_overview_count"),DOM.appendA(t,"icon icon_delete","",{action:{action:"icon",tab:"Player",icon:"remove"}}),OBJ.iterateArray(e,function(e){var t,a;OBJ.is(e)&&(a=i===e.id?HTML.classType(1):"",t={action:{action:"toggle",tab:"Player",token:o,id:e.id}},t=DOM.appendTR(n,a,t),DOM.appendTD(t,"ago_panel_overview_coords"),DOM.appendTD(t,"ago_panel_overview_name",e.name||e.id),a=DOM.appendTD(t,"ago_panel_overview_count"),"remove"===AGO.Panel.Get("Player","icon",6)&&(t={message:{page:"Token",role:"Action",data:{action:"remove",tab:"Player",token:o,id:e.id}}},DOM.appendA(a,"icon icon_delete","",t)))}),DOM.hasChildren(n)<2&&DOM.setStyleDisplay(n)},appendTable:function(e){return DOM.appendTABLE(e,"ago_panel_overview",{width:AGO.Panel.innerWidth+"px"},[60,AGO.Panel.innerWidth-85,25])},appendTarget:function(o,i,l,e){var t,a,s,p;p=AGO.Option.get("I84",2),s=AGO.Option.get("I85",2),2===p&&s<10&&(p=1),t=DOM.appendTR(o),a=DOM.appendTD(t,"ago_panel_overview_coords",["","∇","∇ "+s][p]),DOM.setData(a,null,{action:{action:"sort",tab:"Target",value:1===p?2:1}}),a=DOM.appendTD(t,"ago_panel_overview_name",p?"":"∇"),DOM.setData(a,null,{action:{action:"sort",tab:"Target",value:0}}),a=DOM.appendTD(t,"ago_panel_overview_count"),DOM.appendA(a,"icon icon_delete","",{action:{action:"icon",tab:"Target",icon:"remove"}}),OBJ.iterateArray(e,function(e){var t,a,n;OBJ.is(e)&&(n=STR.check(e.coords).split(":"),(p<2||AGO.Acc.galaxy===+n[0]&&NMR.isMinMax(+n[1],AGO.Acc.system-s,AGO.Acc.system+s))&&(n=+n[3]||1,a=l===e.id?HTML.classType(n):"",t={tab:"Target",data:i,action:{action:"toggle",tab:"Target",token:i,id:e.id}},t=DOM.appendTR(o,a,t),DOM.appendTD(t,"ago_panel_overview_coords",AGO.Task.cutCoords(e.coords)),a=DOM.appendTD(t,"ago_panel_overview_name"),1<n&&DOM.appendIMG(a,HTML.urlTypeIcon(n),"11px"),e.time?DOM.appendTEXT(a,e.time,17):DOM.appendTEXT(a,e.name),a=DOM.appendTD(t,"ago_panel_overview_count"),"remove"===AGO.Panel.Get("Target","icon",6)&&(t={message:{page:"Token",role:"Action",data:{action:"remove",tab:"Target",token:i,id:e.id}}},DOM.appendA(a,"icon icon_delete","",t))))}),DOM.hasChildren(o)<2&&DOM.setStyleDisplay(o)},parseTarget:function(e){e&&e.target&&("dblclick"===e.type?e.target.value="":((e=AGO.Task.parseTarget(e.target.value)).coords||e.time)&&AGO.Token.Action({action:"set",tab:"Target",coords:e.coordstype||e.coords,time:e.time,token:81,marked:1}))},createTools:function(e,t){var a,n,o,i,l,s,p;if(AGO.Option.is("T00")){for(AGO.Panel.createSettings(e,t,"","intern"),a=document.createDocumentFragment(),s=1;s<=9;s++){for((n=document.createElement("ul")).className="ago_panel_links",DOM.appendLI(n,"ago_panel_links_header","T"+s+"0",10),p=0;p<AGO.Tools.List.length;p++)l="T"+s+AGO.Tools.List[p],AGO.Option.is(l)&&(o=DOM.appendLI(n),i={message:{page:"Tools",role:"Action",data:{tab:"Player",id:l}}},DOM.appendA(o,"",null,i).textContent=AGO.Option.getPair(l)[0]||AGO.Label.get(l));1<DOM.hasChildren(n)&&a.appendChild(n)}DOM.replaceChildren(DOM.getChildren(e,2),a)}},Action:function(a){var n,e;"Construction"===(n=OBJ.get(a,"tab"))?AGB.message("Construction","Action",{action:a.action,value:a.value,coords:AGO.Acc.coordstype},AGO.Panel.Display):VAL.check(n,"Alliance","Player","Target")&&("sort"===a.action?(AGO.Option.set("I84",a.value,2),AGO.Panel.Display()):"icon"===a.action?(a.icon=AGO.Panel.Get(n,"icon",6)===a.icon?"":a.icon,AGO.Panel.set(n,"icon",a.icon,!0),AGO.Init.Messages("Main","Display"),AGO.Panel.Display()):2===a.marked||a.marked&&!AGO.Option.is("I82")?AGO.Panel.Display({tab:n,data:a.token}):("toggle"===a.action&&(a.action=AGO.Panel.GetActive(n,"id",6)===a.id?"deselect":"select","Target"===n&&VAL.check(AGO.App.page,"fleet1","fleet2")&&(a.action="select")),e=VAL.check(a.action,"remove","deselect")?"":a.id,AGB.message("Token","Get",{tab:n,token:a.token,id:e},function(e){var t;AGO.Panel.set(n,"active",e),AGO.Panel.Display({tab:n,data:a.token}),t={arrival:+OBJ.get(e,"time")||0},AGO.Task.updateCoordsType(t,OBJ.get(e,"coords")),OBJ.copy(t,a),"Player"===n?AGO.Init.Messages("Box","Action",{tab:n}):"Target"===n&&(AGO.Init.Messages("Main","Display"),AGO.Init.Messages(["Fleet1","Fleet2","Fleet3"],"Action",t)),AGO.Init.Messages(["Galaxy"],"Action",a)})))},click:function(e){var t;if(e&&e.target){if(t=DOM.getData(e.target,null,2),AGO.Panel.updateDisplayLock||e.target.hasAttribute("disabled"))return e.stopPropagation(),e.preventDefault(),!1;OBJ.is(t.setting)?"INPUT"!==e.target.nodeName&&DOM.click("input","LI"===e.target.nodeName?e.target:e.target.parentNode):(OBJ.is(t.message)&&("Tools"===t.message.page&&OBJ.set(t.message.data,"shiftKeys",e.shiftKey||e.ctrlKey),AGO.Init.Messages(t.message.page,t.message.role,t.message.data)),OBJ.is(t.action)?AGO.Panel.Action(t.action):OBJ.is(t.update)?AGO.Panel.Display(t.update):t.tab&&AGO.Panel.Display(t),"ago_panel_button"===e.target.id||"ago_panel_arrow"===e.target.className?2<=(e=DOM.getAttribute("ago_panel_button","id","ago_display_status",2))?AGO.Panel.panelInactive(!0):AGO.Panel.panelActive(3):AGO.Panel.panelActive(2))}},hover:function(e){var t;e&&e.target&&(t=AGO.Panel.hoverStatus,AGO.Panel.mouseStatus="mouseover"===e.type,AGO.Panel.mouseStatus&&(!AGO.Option.is("I02")&&VAL.check("ago_panel_button",e.target.id,e.target.parentNode.id)||AGO.Panel.panelActive(1),AGO.Panel.hoverStatus=AGO.Panel.displayStatus<2?1:"ago_panel_button"===e.target.id||"ago_panel_arrow"===e.target.className?1:0),t!==AGO.Panel.hoverStatus&&DOM.updateAttribute("ago_panel_button","id","ago_hover_status",t,8))},hoverExtern:function(e){AGO.Panel.enabled&&2<=AGO.Panel.displayStatus&&(AGO.Panel.mouseStatus=Boolean(e))},panelActive:function(e){AGO.Panel.displayStatus=AGO.Panel.displayStatus||DOM.getAttribute("ago_panel_button","id","ago_display_status",2),AGO.Panel.enabled&&AGO.Panel.displayStatus<e&&(AGO.Panel.mouseCount<=0&&window.setTimeout(AGO.Panel.panelInactive,500),AGO.Panel.mouseCount=5,AGO.Panel.displayStatus=e,AGO.Panel.slideLeft=-(Math.ceil(Math.max((+document.body.clientWidth||0)-1e3,2)/2)-1),2<=e&&AGO.Panel.left<AGO.Panel.slideLeft&&DOM.updateStyle("ago_panel","id","left",AGO.Panel.slideLeft+"px"),DOM.updateAttribute("ago_panel_button","id","ago_display_status",NMR.minMax(e,0,2),8))},panelInactive:function(e){AGO.Panel.enabled&&(AGO.Panel.mouseStatus||AGO.Panel.mouseCount--,e||AGO.Panel.mouseCount<=0&&AGO.Panel.displayStatus<3?(AGO.Panel.displayStatus=0,DOM.updateAttribute("ago_panel_button","id","ago_display_status",0,8),DOM.updateStyle("ago_panel","id","left",AGO.Panel.left+"px")):AGO.Panel.displayStatus<3&&window.setTimeout(AGO.Panel.panelInactive,500))}},AGO.Box={Data:{},Messages:function(e,t){"Action"===e&&AGO.Box.Action(t)},Init:function(e,t){AGO.Box.enabled=!0,AGO.Box.Data=OBJ.is(e)?e:{},t&&AGO.Box.Display()},Run:function(){var e;e=AGO.Panel.Get("Box","data",6),AGO.Box.enabled&&e&&(OBJ.get(AGO.Box.Data.Cache,"tab")?AGO.Box.Show(AGO.Box.Data.Cache):AGO.Box.Display())},Show:function(e){var t,a,n,o,i,l;if(e&&e.playerName&&Array.isArray(e.planets)){for(a=document.createDocumentFragment(),t=0;t<e.planets.length;t++)(o=e.planets[t])&&((i=AGO.Task.splitCoords(o.coords)).tab="Target",i.id=o.coords,i.type=1,i.action="set",l="&galaxy="+i.galaxy+"&system="+i.system+"&position="+i.position,n=o.planetId===e.planetHome?"ago_box_homeplanet":"",n=DOM.appendDIV(a,n),"galaxy"===AGO.App.page?DOM.appendA(n,null,null,{message:{page:"Page",role:"Action",data:i}}).textContent=o.coords:DOM.appendA(n,{href:"index.php?page=galaxy"+l}).textContent=o.coords,VAL.check(AGO.App.page,"fleet1","fleet2","fleet3")?(DOM.appendA(n,null,null,{message:{page:"Page",role:"Action",data:i}}).textContent=o.planetName,o.moonId&&(i.type=3,n=DOM.appendA(n,null,null,{message:{page:"Page",role:"Action",data:i}}),DOM.appendIMG(n,HTML.urlTypeIcon(3,"a"),"14px"))):(DOM.appendA(n,{href:"index.php?page=fleet1"+l+"&type=1"}).textContent=o.planetName,o.moonId&&(n=DOM.appendA(n,{href:"index.php?page=fleet1"+l+"&type=3"}),DOM.appendIMG(n,HTML.urlTypeIcon(3,"a"),"14px"))));o=e.playerName+"|Planets: "+e.planets.length+"<BR>",(t=document.getElementById("ago_box"))?(DOM.setAttribute("ago_box_title","id","title",o),DOM.setText("ago_box_title","id",e.playerName),DOM.replaceChildren(document.getElementById("ago_box_content"),a),DOM.setStyleDisplay(t,null,"block")):a&&(t=DOM.appendDIV(null,{class:"ago_box",id:"ago_box"},{fontSize:"9px"}),n=DOM.appendDIV(t,{id:"ago_box_header"}),DOM.appendA(n,"ago_box_icon22 galaxy highlighted",{click:AGO.Box.clickGalaxy}),DOM.appendA(n,"ago_box_icon22 galaxy highlighted",null,{task:"home"}),DOM.appendSPAN(n,{id:"ago_box_title",class:"tooltipHTML",title:o},e.playerName),DOM.appendA(n,"ago_icon_close",null,{action:{action:"remove"}}),(n=DOM.appendDIV(t,{id:"ago_box_content"})).appendChild(a),DOM.appendChild(document.getElementById("toolLinksWrapper"),t),DOM.addEvents("ago_box","id",{click:AGO.Box.click}))}else DOM.setStyleDisplay("ago_box","id")},Display:function(){var e,t;e=AGO.Panel.Get("Box","data",6),t=AGO.Panel.GetActive(e,"id",6),"Player"===e&&t?AGB.message("Box","List",{tab:e,id:t,planets:1},AGO.Box.Show):AGO.Box.Show()},click:function(e){e&&e.target&&("home"===(e=DOM.getData(e.target,null,2)).task&&DOM.click("#ago_box_content .ago_box_homeplanet a:first-child"),OBJ.is(e.action)&&AGO.Box.Action(e.action),OBJ.is(e.message)&&AGO.Init.Messages(e.message.page,e.message.role,e.message.data))},Action:function(e){AGO.Box.enabled&&OBJ.is(e)&&("remove"===e.action&&(AGB.message("Box","List",{tab:e.tab}),e.tab=""),AGO.Panel.set("Box","data",e.tab),AGO.Box.Display())}},AGO.Events={status:0,included:!1,Messages:function(e,t){"highlight"===e&&AGO.Events.displayHighlight(t)},Run:function(){var e,t;AGO.Events.status=1,AGO.Option.is("E30")&&(AGO.Events.enabled=!0,AGO.Events.improve=AGO.Option.is("E31"),AGO.Events.modeAbbreviation=AGO.Option.is("E32"),AGO.Events.modeColorMissions=AGO.Option.is("CM0")),(e=document.getElementById("eventboxContent"))&&(AGO.Events.included=Boolean(document.getElementById("eventListWrap")),AGO.Events.enabled&&(t=!AGO.Events.included&&AGO.Events.modeBehavior<5?" ago_eventlist_hide":"",DOM.extendClass(e,null,"ago"+t),t=AGO.Events.modeBehavior?VAL.check(AGO.Events.modeBehavior,2,4,6,8)?3:AGO.Option.is("E34")?2:1:AGO.Events.included?1:0,e.setAttribute("ago_display_status",t),AGO.Events.modeBehavior&&(DOM.getChildren(e.parentNode,0)===e?AGO.Events.modeBehaviorAbove||e.parentNode.appendChild(e):AGO.Events.modeBehaviorAbove&&DOM.prependChild(e.parentNode,e),AGO.Styles.set("#eventboxContent:not(:first-child), #eventboxContent:first-child { display: inherit; }"))),AGO.Events.included&&AGO.Events.Content())},Ready:function(){AGO.Events.enabled&&AGO.Events.modeBehavior&&AGO.Events.modeBehavior<5&&(DOM.setStyleDisplay("eventboxContent","id"),AGO.Styles.set("#eventboxContent, #eventboxContent #eventListWrap { display: block; }"))},Content:function(){var e,t,a,n,o,i,l,s;if(o=1,AGO.Events.eData={},AGO.Events.last=0,e=document.getElementById("eventboxContent"),t=document.getElementById("eventListWrap"),AGO.Events.status&&e&&t&&DOM.updateAttribute(t,null,"ago-status",1,8)){for(AGO.Events.status=2,AGO.Events.enabled&&(DOM.removeClass(e,null,"ago_eventlist_hide"),e=t.querySelector("#eventHeader"))&&(n=document.createDocumentFragment(),a=DOM.appendA(n,null,{click:function(){AGO.Global.message({role:"reloadEvents"})}}),a=DOM.appendSPAN(a,"icon icon_reload ago_eventlist_reload"),AGO.Events.improve&&(DOM.appendSPAN(n,"ago_display_arrow"),e.addEventListener("click",AGO.Events.toggleEvents,!1)),DOM.prependChild(e,n)),e=t.querySelectorAll("table#eventContent > tbody > tr"),a=0;a<e.length;a++)n=NMR.parseIntAbs(e[a].getAttribute("data-mission-type")),HTML.hasClass(e[a].className,"allianceAttack")?(i="F"+(l=STR.check(NMR.parseIntAbs(e[a].className))),s=1):HTML.hasClass(e[a].className,"partnerInfo")?s=(l=STR.check(NMR.parseIntAbs(e[a].className)))===(i=DOM.getAttribute(".icon_movement span",e[a],"data-federation-user-id",7))?2:3:(s=l=0,i=STR.check(NMR.parseIntAbs(e[a].id))),AGO.Events.eData[i]={id:i,mission:n,arrival:+e[a].getAttribute("data-arrival-time")||0,union:l||"",unionType:s||0,reverse:"true"===e[a].getAttribute("data-return-flight")},AGO.Events.modeColorMissions&&AGO.Events.eData[i].reverse&&(e[a].className+=" ago_events_reverse"),e[a].addEventListener("click",AGO.Events.clickRow,!1),AGO.Events.parseRow(e[a],AGO.Events.eData[i]),1!==s&&(AGO.Task.updateShips(AGO.Events.eData[i]),AGO.Task.updateResources(AGO.Events.eData[i]),3<=AGO.Events.eData[i].fleetType&&1!==s&&4!==n&&(AGO.Events.eData[i].pair=AGO.Events.eData[i].reverse?AGO.Events.eData[i-1]?AGO.Events.eData[i-1].pair:"":(5===n||15===n)&&AGO.Events.eData[i-1]&&AGO.Events.eData[i-1].pair?AGO.Events.eData[i-1].pair:o++),AGO.Events.improve&&(AGO.Events.eData[i].pair&&(e[a].setAttribute("ago-events-pair",AGO.Events.eData[i].pair),e[a].addEventListener("mouseover",AGO.Events.displayPair,!1),e[a].addEventListener("mouseout",AGO.Events.displayPair,!1)),AGO.Events.createDetails(e[a],AGO.Events.eData[i])));for(i in AGO.Events.eData)AGO.Events.eData.hasOwnProperty(i)&&(1===AGO.Events.eData[i].unionType&&(AGO.Task.updateShips(AGO.Events.eData[i]),AGO.Task.updateResources(AGO.Events.eData[i]),AGO.Events.improve&&AGO.Events.createDetails(t.querySelector("table#eventContent tr.union"+AGO.Events.eData[i].union),AGO.Events.eData[i])),2===AGO.Events.eData[i].fleetType&&5===AGO.Events.eData[i].mission&&AGO.Events.eData[i-1]&&(AGO.Events.eData[i].nocalc=!0));e=t=e=a=e=n=null}},parseRow:function(e,n){DOM.iterateChildren(e,function(e){var t;if(t=e.className,HTML.hasClass(t,"countDown"))DOM.addClass(e,null,HTML.classMission(n.mission)),e.className+=" ago_panel_add",n.fleetType=HTML.hasClass(t,"neutral")?2:HTML.hasClass(t,"hostile")?1:n.reverse?4:3;else if(HTML.hasClass(t,"arrivalTime"))t=(e.textContent||"").split(" ")[0],e.textContent=AGO.Time.convertLocal(t,"[H]:[i]:[s]");else if(HTML.hasClass(t,"missionFleet"))n.missionName=2<=n.unionType?"":n.unionType?AGO.Label.get("LM02"):DOM.getAttribute("img",e,"title",7).split("|")[1];else if(HTML.hasClass(t,"originFleet"))(t=e.querySelector("figure"))&&(n.typeOrigin=HTML.hasClass(t.className,"moon")?3:HTML.hasClass(t.className,"tf")?2:1);else if(HTML.hasClass(t,"coordsOrigin"))(t=e.querySelector("a"))&&(n.coordsOrigin=AGO.Task.trimCoords(t.textContent),n.owncoordsOrigin=AGO.Planets.owncoords(n.coordsOrigin,n.typeOrigin),n.owncoordsOrigin&&(n.reverse||(5===n.mission||15===n.mission)&&AGO.Events.last===+n.id-1||(AGO.Events.last=Math.max(AGO.Events.last,+n.id||0)),DOM.addClass(t,null,AGO.Token.getClassSelection(n.typeOrigin)),3<=n.owncoordsOrigin&&DOM.extendClass(e,null,AGO.Token.getClassHighlight(n.typeOrigin))));else if(-1<t.indexOf("icon_movement")){var a;if((t=e.querySelector("span"))&&1!==n.unionType)if(e=t.title)for(e=e.split("<td>"),2<=n.unionType&&AGO.Events.eData["F"+n.union]&&(AGO.Events.eData["F"+n.union].fleets=(AGO.Events.eData["F"+n.union].fleets||0)+1),t=1;t<e.length;t++)a=(e[t].split("</td>",1)[0]||"").replace(/\:/g,"").trim(),(a=AGO.Item.getByName(a))&&(n[a]=NMR.parseIntAbs(e[t].split(">",3)[2]),n[a]&&2<=n.unionType&&AGO.Events.eData["F"+n.union]&&(AGO.Events.eData["F"+n.union][a]=(AGO.Events.eData["F"+n.union][a]||0)+n[a]))}else HTML.hasClass(t,"destFleet")?(t=e.querySelector("figure"))&&(n.type=HTML.hasClass(t.className,"moon")?3:HTML.hasClass(t.className,"tf")?2:1):HTML.hasClass(t,"destCoords")?(t=e.querySelector("a"))&&(n.coords=AGO.Task.trimCoords(t.textContent),n.owncoords=AGO.Planets.owncoords(n.coords,n.type),n.owncoords&&(DOM.addClass(t,null,AGO.Token.getClassSelection(n.type)),3<=n.owncoords&&DOM.extendClass(e,null,AGO.Token.getClassHighlight(n.type)))):HTML.hasClass(t,"sendMail")&&(n.nick=DOM.getAttribute(DOM.getChildnodeByName(e,"A"),null,"data-player-name",7))})},createDetails:function(e,t){var a,n,o;1===t.unionType&&t.fleets&&DOM.setText(".originFleet",e,t.fleets+" / 16"),2<=t.unionType&&DOM.setText(".descFleet",e),2===t.unionType&&DOM.setText(".countDown",e,"E28",10),(a=document.createElement("td")).className="ago_eventlist_activity",t.fleetType<3?DOM.appendIMG(a,1===t.fleetType?"/cdn/img/galaxy/activity15.gif":"/cdn/img/galaxy/activity.gif","14px"):a.textContent=t.pair||"",DOM.prependChild(e,a),(a=document.createElement("tr")).className="ago_eventlist",t.pair&&(a.setAttribute("ago-events-pair",t.pair),a.addEventListener("mouseover",AGO.Events.displayPair,!1),a.addEventListener("mouseout",AGO.Events.displayPair,!1)),(n=DOM.appendTD(a)).setAttribute("colspan",12),o=DOM.appendDIV(n,"ago_eventlist_left"),t.nick&&!t.owncoordsOrigin&&DOM.appendSPAN(o,"ago_eventlist_player",t.nick),DOM.appendSPAN(o,HTML.classMission(t.mission),t.missionName),function(e,t){function a(e,t,a,n){e=DOM.appendTD(e),t&&a&&(DOM.appendSPAN(e,"ago_eventlist_label",t,n),DOM.appendTEXT(e,a,2))}var n,o,i,l,s,p;for(s in i=AGO.Option.is("E32")?12:11,l={ShipCivil:[],ShipCombat:[],Resource:[]},n=e.appendChild(document.createElement("table")),a(o=DOM.appendTR(n),"I28",t.shipsCivil||"0",10),a(o,"I29",t.shipsCombat||"0",10),a(o,"I27",t.resources||"0",10),l)if(l.hasOwnProperty(s))for(p in AGO.Item[s])AGO.Item[s].hasOwnProperty(p)&&0<t[p]&&l[s].push(p);for(s=0;s<9&&(l.ShipCivil[s]||l.ShipCombat[s]||l.Resource[s]);s++)a(o=DOM.appendTR(n),l.ShipCivil[s],t[l.ShipCivil[s]],i),a(o,l.ShipCombat[s],t[l.ShipCombat[s]],i),a(o,l.Resource[s],t[l.Resource[s]],i);n=o=null}(o=DOM.appendDIV(n,"ago_eventlist_fleet"),t),o=DOM.appendDIV(n,"ago_eventlist_right"),t.nick&&!t.owncoords&&DOM.appendSPAN(o,"ago_eventlist_player",t.nick),DOM.after(e,a),a=n=o=null},toggleEvents:function(e){!e.target||"H4"!==e.target.nodeName&&"ago_display_arrow"!==e.target.className||(e=DOM.getAttribute("eventboxContent","id","ago_display_status",2)+1,DOM.setAttribute("eventboxContent","id","ago_display_status",3<e?1:e,8))},clickRow:function(e){var t;e&&e.target&&HTML.hasClass(e.target.className,"countDown")&&(t=NMR.parseIntAbs(e.target.id))&&AGO.Events.eData[t]&&((e={action:"set",tab:"Target",marked:1,token:81,time:AGO.Events.eData[t].arrival,name:AGO.Events.eData[t].nick}).coords=AGO.Events.eData[t].reverse?AGO.Events.eData[t].coordsOrigin+":"+AGO.Events.eData[t].typeOrigin:AGO.Events.eData[t].coords+":"+AGO.Events.eData[t].type,AGO.Init.Messages("Token","Action",e))},displayPair:function(e){var t,a;a=this.getAttribute("ago-events-pair"),(t=document.getElementById("eventboxContent"))&&0<a&&("mouseover"===e.type?DOM.iterate(t.querySelectorAll('.eventFleet[ago-events-pair="'+a+'"], .ago_eventlist[ago-events-pair="'+a+'"]'),function(e){DOM.addClass(e,null,"ago_eventlist_pair")}):DOM.iterate(t.querySelectorAll(".eventFleet, .ago_eventlist"),function(e){DOM.removeClass(e,null,"ago_eventlist_pair")}))},displayHighlight:function(e){AGO.Events.highlightCurrent=e||0},calculate:function(e){function t(e,t,a){return e[t]||(e[t]={}),e[t][a]||(e[t][a]={metal:0,crystal:0,deuterium:0,resources:0,fleets:0,shipment:0,ships:0,shipsCivil:0,shipsCombat:0,reverse:0,timeResource:1,timeShip:1}),e[t][a]}function a(e,t,a,n,o){function i(e,t,a,n,o){a[e]=(a[e]||0)+t,n[e]=(n[e]||0)+t,o[e]=(o[e]||0)+t}var l;if(!o||"resources"===o)for(l in AGO.Item.Resource)e[l]&&(i(l,e[l],t,a,n),i("resources",e[l],t,a,n));if(!o||"ships"===o){for(l in AGO.Item.Ship)e[l]&&(i(l,e[l],t,a,n),i("ships",e[l],t,a,n),l in AGO.Item.ShipCivil&&i("shipsCivil",e[l],t,a,n),l in AGO.Item.ShipCombat&&i("shipsCombat",e[l],t,a,n));i("fleets",1,t,a,n)}}var n,o,i,l,s,p,r;if(n={},2<=AGO.Events.status)for(i in n.account={},AGO.Events.eData)0<+i&&(o=AGO.Events.eData[i],"ownership"===e?o.reverse?(r="own",s=o.coordsOrigin,l=o.coordsOrigin+":"+o.typeOrigin,p=o.typeOrigin,a(o,t(n,"account",r),t(n,s,r),t(n,l,r),"ships"),3===o.mission&&o.pair&&(s=o.coords,l=o.coords+":"+o.type,p=o.type),a(o,t(n,"account",r),t(n,s,r),t(n,l,r),"resources")):(s=o.coords,l=o.coords+":"+o.type,p=o.type,(r=2===o.fleetType&&3===o.mission?"neutral":3<=o.fleetType&&4===o.mission?"own":"")&&a(o,t(n,"account",r),t(n,s,r),t(n,l,r))):(o.reverse?(s=o.coordsOrigin,l=o.coordsOrigin+":"+o.typeOrigin,p=o.typeOrigin,r=o.pair?"":"back"):(s=o.coords,l=o.coords+":"+o.type,p=o.type,r=o.nocalc||!o.fleetType?"":1===o.fleetType?"hostile":2===o.fleetType?"neutral":o.owncoords?"own":""),r&&a(o,t(n,"account",r),t(n,s,r),t(n,l,r))),r&&(n[l][r].coords=s,n[l][r].coordstype=l,n[l][r].type=p));return n}};