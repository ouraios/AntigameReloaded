if(!AGO)var AGO={};AGO.Jumpgate={updateCooldownStatus:0,Messages:function(e,t){"Continue"===e&&AGO.Jumpgate.Continue(t)},Unload:function(e){e&&e.target&&"DIV"===e.target.nodeName&&-1<(e.target.className||"").indexOf("ui-dialog")&&(AGO.Jumpgate.Timer=null,AGO.Init.Messages("Planets","Action",{mode:"select"}))},onKeydown:function(e,t){if(13===e.keyCode)return document.activeElement.blur(),DOM.click(".secondcol input.btn_blue",t),!1;if(65===e.keyCode)return DOM.click(".secondcol #sendall",t),!1;if(77===e.keyCode)return DOM.click(".secondcol #sendmost",t),!1;if(81===e.keyCode)return DOM.click(".secondcol .send_none a",t),!1;if(38===e.keyCode||40===e.keyCode){if(11===e.inputType&&e.target.id&&AGO.Item.Ship[STR.check(NMR.parseIntAbs(e.target.id))])return DOM.changeInput(e,e.target)}else if(112<=e.keyCode&&e.keyCode<=123&&AGO.Option.is("U32")&&!e.cached)return AGO.Jumpgate.Action(AGO.Planets.GetByIndex(e.keyCode-111,"moon",6)),!1;return!0},Content:function(e){function t(e,t){var a,n;(a=DOM.appendTR(e,"tooltip")).addEventListener("click",o,!1),(n=DOM.appendTD(a,"ago_jumpgate_settings_name tooltip",t,10)).title=n.textContent,n=DOM.appendTD(a,"ago_jumpgate_settings_status"),DOM.append(n,"input",{id:"ago_jumpgate_settings_status_"+t,type:"checkbox",rel:t})}function o(e){var t,a;e&&e.currentTarget&&(t=e.currentTarget.querySelector("input"),a=DOM.getAttribute(t,null,"rel"),t&&a&&("INPUT"!==e.target.nodeName&&(t.checked=!t.checked),AGO.Option.set(a,t.checked?1:0,1),AGO.Global.message({role:"Data",data:{G33:AGO.Option.is("G33"),G34:AGO.Option.is("G34")}})))}function s(e){e&&AGO.Init.Messages("Panel","hover","mouseover"===e.type)}var a,l,n,i;if(e=e?e.querySelector("#jumpgate"):null,AGO.Option.is("G30")&&!AGO.App.OgameMobile&&DOM.updateAttribute(e,null,"ago-status",1,8)){for(AGO.Option.is("G31")&&DOM.addClass(e,null,"ago_jumpgate_improve"),AGO.Jumpgate.Mini=AGO.Task.splitActive(AGO.Option.get("G38",-1),2,-1),AGO.Jumpgate.Maxi={},a=e.querySelectorAll(".ship_selection_table .ship_txt_row > a"),i=0;i<a.length;i++)(n=STR.check(DOM.getAttribute("img",a[i],"class",3)))&&(AGO.Jumpgate.Maxi[n]=DOM.getText(".quantity",a[i].parentNode,3)),DOM.appendChild(a[i],a[i].parentNode.children[1]);if(a={planet:AGO.Acc.planetId,tabs:["Ship"],data:OBJ.create(AGO.Jumpgate.Maxi)},AGB.message("Units","Action",{list:[a]}),n=DOM.appendSPAN(null,"float_left send_most"),DOM.appendA(n,{id:"sendmost",class:"tooltip",title:AGO.Label.get("F37")},{click:AGO.Jumpgate.setMostShips}),DOM.after(e.querySelector(".secondcol .send_all"),n),AGO.Jumpgate.Target=[],(a=e.querySelector('#jumpgateForm select[name="zm"]'))&&a.options){for(i=0;i<a.options.length;i++)n=AGO.Task.trimCoords(a.options[i].textContent),n=AGO.Planets.GetByCoords(n,"index")||80+AGO.Jumpgate.Target.length,AGO.Jumpgate.Target[n]={value:a.options[i].value,text:a.options[i].textContent};AGO.Option.is("G32")&&((n=document.createElement("option")).value="none",n.textContent=" - ",DOM.prependChild(a,n),e.querySelector("#jumpgateDefaultTargetSelectionForm option[selected]")||(a.selectedIndex=0)),a.onchange=AGO.Jumpgate.Display}AGO.Jumpgate.Target.length?(AGO.Option.is("G31")&&(DOM.setStyleDisplay("#jumpgate h4",e),DOM.setStyleDisplay("#selecttarget > .fright",e),(l=DOM.appendTABLE(null,{id:"ago_jumpgate_target"},{width:"378px"},[20,60,90,26,24,90,65])).addEventListener("click",AGO.Jumpgate.clickTarget,!1),l.addEventListener("dblclick",AGO.Jumpgate.clickTarget,!1),AGO.Planets.iterate(3,function(e,t){if(t&&(AGO.Jumpgate.Target[e.index]||t===AGO.Acc.planetId||1e3<AGO.Fleet.Get("Cooldown",t,2))){var a,n=l,o=e.index;a=AGO.Jumpgate.Target[o]?AGO.Token.getClassHover(3,"own"):AGO.Planets.Get("active","index")===o?AGO.Token.getClassHighlight(3)+" ago_color_palered":"ago_color_palered",n=DOM.appendTR(n,a,{role:"Task",data:t}),o=AGO.Option.isAnd("U31","U32")?o:"",DOM.appendTD(n,"ago_jumpgate_target_shortkey",o),DOM.appendTD(n,"",AGO.Planets.Data[t].coords),DOM.appendTD(n,"ago_jumpgate_target_name",AGO.Planets.Data[AGO.Planets.Data[t].planet].name),o=DOM.appendTD(n),DOM.appendSPAN(o,"ago_jumpgate_cooldown"),o=DOM.appendTD(n),DOM.appendIMG(o,AGO.Planets.Data[t].img,"16px"),DOM.appendTD(n,"ago_jumpgate_target_name",AGO.Planets.Data[t].name),(o=DOM.appendTD(n,{class:"ago_jumpgate_target_ships ago_color_normal","ago-data-change":JSON.stringify({page:"Panel",role:"hover"})},"-")).addEventListener("mouseover",s,!1),o.addEventListener("mouseout",s,!1)}}),DOM.prependChild(e.querySelector("#selecttarget"),l),t(l=DOM.appendTABLE(null,"ago_jumpgate_settings ago_color_normal",{width:"215px"},[175,25]),"G34"),t(l,"G35"),DOM.after(e.querySelector("#selecttarget > .fright"),l),AGB.message("Units","List",{action:"summarized"},function(e){var t,a;for(t=document.querySelectorAll("#ago_jumpgate_target > tr"),i=0;i<t.length;i++)a=DOM.getAttribute(t[i],null,"ago-data",-2).data,OBJ.get(e[a],"timeShip")&&DOM.updateText("td.ago_jumpgate_target_ships",t[i],OBJ.get(e[a],"ships"),2)}),AGO.Jumpgate.updateCooldown(!0),AGO.Jumpgate.Timer=AGO.Jumpgate.updateCooldown),AGO.Global.message({role:"Jumpgate"}),e.parentNode.parentNode.addEventListener("DOMNodeRemoved",AGO.Jumpgate.Unload,!1),AGO.Jumpgate.Display(),AGO.Global.message({role:"Data",data:{G33:AGO.Option.is("G33"),G34:AGO.Option.is("G34")}}),DOM.addEventsAll("#jumpgate .send_none a",null,{click:AGO.Jumpgate.Display}),DOM.disableActiveElement(),DOM.disableAutocomplete()):(l=document.querySelector("#jumpgateNotReady #cooldown"))&&(e=AGO.Time.parseFormatedTime(l.textContent))&&AGO.Fleet.Set("Cooldown",AGO.Planets.GetId("active"),AGO.Time.timestamp()-Math.ceil(3600/AGO.Uni.speedFleet)+e)}e=a=l=a=n=null},updateCooldown:function(e){var t,a,n,o=0;if(e||-4<AGO.Jumpgate.updateCooldownStatus){for(e=document.querySelectorAll("#ago_jumpgate_target > tr"),a=0;a<e.length;a++)t=DOM.getAttribute(e[a],null,"ago-data",-2).data,1e5<(n=AGO.Fleet.Get("Cooldown",AGO.Planets.GetId(t),2))&&(0<=(n=3600/AGO.Uni.speedFleet-(AGO.Time.timestamp()-n))&&(o++,t=e[a].getElementsByClassName("ago_jumpgate_cooldown")[0],n<=60&&DOM.updateClass(t,null,"ago_jumpgate_cooldown ago_jumpgate_cooldown_seconds"),n=60<n?Math.ceil(n/60):Math.floor(n),DOM.updateText(t,null,Math.floor(n))));AGO.Jumpgate.updateCooldownStatus=o||AGO.Jumpgate.updateCooldownStatus-1}},Continue:function(e){var t,a,n,o;if((t=document.getElementById("jumpgate"))&&e){for((a={})[AGO.Planets.GetId(e)]=AGO.Time.timestamp(),a[AGO.Planets.GetId("active")]=AGO.Time.timestamp(),AGO.Fleet.Set("Cooldown",a),a={},t=t.querySelectorAll(".ship_selection_table td.ship_input_row > input"),n=0;n<t.length;n++)(o=NMR.parseIntAbs(t[n].id))&&(a[o]=NMR.parseIntAbs(t[n].value));e=[{planet:AGO.Acc.planetId,tabs:["Ship"],action:"remove",data:a},{planet:e,tabs:["Ship"],action:"add",data:a}],AGB.message("Units","Action",{list:e})}},setMostShips:function(){var e,t,a={};AGO.Units.activeResources(AGO.Jumpgate.Maxi),OBJ.iterate(AGO.Jumpgate.Maxi,function(e){a[e]=Math.max(AGO.Jumpgate.Maxi[e]-(+AGO.Jumpgate.Mini[e]||0),0)}),AGO.Option.is("G35")&&(e=Math.ceil(AGO.Jumpgate.Maxi.resources/25e3),t=0<(t=Math.max(e-(+AGO.Jumpgate.Maxi[203]||0),0))?5*t:0,e>(AGO.Jumpgate.Mini[203]||0)&&(a[203]=Math.max(AGO.Jumpgate.Maxi[203]-e,0)),t>(AGO.Jumpgate.Mini[202]||0)&&(a[202]=Math.max(AGO.Jumpgate.Maxi[202]-t,0))),AGO.Global.message({role:"setMostShips",data:a})},clickTarget:function(e){var t;e&&e.target&&(t=DOM.getAttributeParent(e.target,null,"ago-data",-2,2),OBJ.copy(DOM.getAttributeParent(e.target,null,"ago-data-change",-2,1),t),"dblclick"===e.type?AGO.Option.is("U34")&&DOM.click("#jumpgate .secondcol input.btn_blue"):"Panel"===t.page?(e=AGO.Planets.Get(t.data,"coordstype",6))&&(AGO.Init.Messages("Panel","Display",{tab:"Account",data:e}),AGO.Init.Messages("Panel","hover",!0)):"Task"===t.role&&AGO.Jumpgate.Action(t.data))},Action:function(e){var t;(t=document.getElementById("jumpgate"))&&e&&(e=t.querySelector('select[name="zm"] option[value="'+e+'"]'))&&DOM.setValue(e.parentNode,null,e.value,0,"change")},Display:function(){var e,t,a,n;(e=document.getElementById("jumpgate"))&&((t=DOM.getSelectedNode(e.querySelector('select[name="zm"]')))&&(((n=AGO.Planets.Get(+t.value,"coords",6))||"none"===t.value)&&(a=e.querySelector("#selecttarget .dropdown > a"),DOM.updateAttribute(a,null,"data-value",t.value),DOM.updateText(a,null,t.textContent),AGO.Init.Messages("Planets","Action",{mode:"select",coords:n,type:3})),AGO.Option.is("G31")&&(DOM.iterate(e.querySelectorAll("#ago_jumpgate_target tr"),function(e){DOM.removeClassGroup(e,null,"ago_selected")}),+t.value&&DOM.setClassGroup('#ago_jumpgate_target tr[ago-data*="'+t.value+'"]',e,"ago_selected",AGO.Token.getClassSelected(3,!0)))),DOM.setProperty("#ago_jumpgate_settings_status_G34",e,"checked",AGO.Option.is("G34")),DOM.setProperty("#ago_jumpgate_settings_status_G35",e,"checked",AGO.Option.is("G35"))),e=a=t=null}},AGO.Phalanx={Messages:function(e,t){AGO.dummy=e+t},Overlay:function(e){var t;e&&(t=e.parentNode.querySelector(".ui-dialog-title"))&&(AGO.Phalanx.coords=AGO.Task.trimCoords(t.textContent),AGO.Option.is("E21")&&!AGO.App.OgameMobile&&(t.style.paddingRight="46px",(t=DOM.appendSPAN(t.parentNode,"ago_display_arrow")).addEventListener("click",AGO.Phalanx.toggleDisplay,!1),e.parentNode.setAttribute("ago_display_status",AGO.Option.get("E23",2))))},Content:function(e){var t,a,n,o,s,l;if(AGO.Phalanx.Data={},e=e?e.querySelector("#phalanxWrap"):null,AGO.Option.is("E20")&&e&&!e.getAttribute("ago-status")&&!AGO.App.OgameMobile){for(e.setAttribute("ago-status",1),t=e.querySelectorAll("div.eventFleet > ul, div.partnerInfo > ul"),AGO.Option.is("E21")&&DOM.addClass(e,null,"ago_phalanx_improve"),l=0;l<t.length;l++)o=n=0,s=STR.check(NMR.parseIntAbs(t[l].parentNode.id)),2===(a=NMR.parseIntAbs(t[l].parentNode.getAttribute("data-mission-type")))&&(o=1,HTML.hasClass(t[l].parentNode.className,"partnerInfo")&&(o=(n=STR.check(NMR.parseIntAbs(t[l].parentNode.className)))===s?2:3,s="F"+s)),AGO.Phalanx.Data[s]={arrival:NMR.parseIntAbs(t[l].parentNode.getAttribute("data-arrival-time")),mission:a,union:n||"",unionType:o||0,reverse:"true"===t[l].parentNode.getAttribute("data-return-flight")},AGO.Phalanx.parseRow(t[l],AGO.Phalanx.Data[s]),1!==AGO.Phalanx.Data[s].unionType&&AGO.Phalanx.createDetails(t[l],AGO.Phalanx.Data[s]),t[l].addEventListener("click",AGO.Phalanx.click,!1);for(s in AGO.Phalanx.Data)1===AGO.Phalanx.Data[s].unionType&&AGO.Phalanx.createDetails(e.querySelector("div#eventRow-"+s+" > ul"),AGO.Phalanx.Data[s])}},parseRow:function(e,t){var a,n,o;for(o=0;o<e.children.length;o++)if(a=e.children[o],n=e.children[o].className,HTML.hasClass(n,"countDown"))(n=a.querySelector("span"))&&(DOM.addClass(n,null,HTML.classMission(t.mission)),DOM.addClass(n,null,"ago_panel_add"),t.fleetType=HTML.hasClass(n.className,"neutral")?2:HTML.hasClass(n.className,"hostile")?1:t.reverse?4:3,2===t.unionType&&(n.textContent=AGO.Label.get("E28")));else if(HTML.hasClass(n,"arrivalTime"))n=(a.textContent||"").split(" ")[0],a.textContent=AGO.Time.convertLocal(n,"[H]:[i]:[s]");else if(HTML.hasClass(n,"descFleet"))t.descFleet=(a.textContent||"").trim(),2<=t.unionType&&(a.textContent="");else if(HTML.hasClass(n,"missionFleet"))t.missionName=DOM.getText("span",a);else if(HTML.hasClass(n,"originFleet"))1===t.unionType?a.textContent=t.descFleet:(n=a.querySelector("figure"))&&(t.typeOrigin=HTML.hasClass(n.className,"moon")?3:HTML.hasClass(n.className,"tf")?2:1);else if(HTML.hasClass(n,"coordsOrigin"))(n=a.querySelector("a"))&&(t.coordsOrigin=AGO.Task.trimCoords(n.textContent),t.owncoordsOrigin=AGO.Planets.owncoords(t.coordsOrigin,t.typeOrigin),t.owncoordsOrigin?(DOM.addClass(n,null,AGO.Token.getClassSelection(t.typeOrigin)),3<=t.owncoordsOrigin&&DOM.extendClass(a,null,AGO.Token.getClassHighlight(t.typeOrigin))):t.coordsOrigin===AGO.Phalanx.coords&&DOM.addClass(n,null,"ago_color_blue"));else if(HTML.hasClass(n,"detailsFleet")){if((n=a.querySelector("span"))&&1!==t.unionType){a=t;var s=void 0,l=void 0,i=l=void 0;if(n=n.title){for(s=n.split("<td>"),i=1;i<s.length;i++)l=(s[i].split("</td>",1)[0]||"").replace(/\:/g,"").trim(),(l=AGO.Item.getByName(l))&&(a[l]=NMR.parseIntAbs(s[i].split(">",3)[2]),a[l]&&2<=a.unionType&&AGO.Phalanx.Data[a.union]&&(AGO.Phalanx.Data[a.union][l]=(AGO.Phalanx.Data[a.union][l]||0)+a[l]));"metal"in a?AGO.Task.updateResources(a):a.resources=-1,AGO.Task.updateShips(a)}}}else HTML.hasClass(n,"destFleet")?(n=a.querySelector("figure"))&&(t.type=HTML.hasClass(n.className,"moon")?3:HTML.hasClass(n.className,"tf")?2:1):HTML.hasClass(n,"destCoords")&&(n=a.querySelector("a"))&&(t.coords=AGO.Task.trimCoords(n.textContent),t.owncoords=AGO.Planets.owncoords(t.coords,t.type),t.owncoords?(DOM.addClass(n,null,AGO.Token.getClassSelection(t.type)),3<=t.owncoords&&DOM.extendClass(a,null,AGO.Token.getClassHighlight(t.type))):t.coords===AGO.Phalanx.coords&&DOM.addClass(n,null,"ago_color_blue"))},createDetails:function(e,t){var a,n;AGO.Option.is("E21")&&e&&((a=document.createElement("li")).className="ago_phalanx_activity",1===t.fleetType?DOM.appendIMG(a,"/cdn/img/galaxy/activity15.gif"):2===t.fleetType&&(t.owncoords?DOM.appendIMG(a,"/cdn/img/galaxy/activity.gif"):t.owncoordsOrigin||1===t.unionType||(a.textContent=t.descFleet[0],a.title=t.descFleet,a.className+=" tooltip")),DOM.prependChild(e,a),a=document.createDocumentFragment(),n=DOM.appendDIV(a,"ago_phalanx_left"),t.unionType<2&&DOM.appendSPAN(n,HTML.classMission(t.mission),t.missionName),function(e,a){function t(e,t,a,n){e=DOM.appendTD(e),t&&a&&(DOM.appendSPAN(e,"ago_phalanx_label",t,n),a<0?DOM.appendTEXT(e,"-----"):DOM.appendTEXT(e,a,2))}var n,o,s,l,i;for(s=AGO.Option.is("E22")?12:11,l={ShipCivil:[],ShipCombat:[],Resource:[]},n=e.appendChild(document.createElement("table")),t(o=DOM.appendTR(n),"I28",a.shipsCivil||"0",10),t(o,"I29",a.shipsCombat||"0",10),t(o,"I27",a.resources||"0",10),OBJ.iterate(l,function(t){OBJ.iterate(AGO.Item[t],function(e){0<a[e]&&l[t].push(e)})}),i=0;i<9&&(l.ShipCivil[i]||l.ShipCombat[i]||l.Resource[i]);i++)t(o=DOM.appendTR(n),l.ShipCivil[i],a[l.ShipCivil[i]],s),t(o,l.ShipCombat[i],a[l.ShipCombat[i]],s),t(o,l.Resource[i],a[l.Resource[i]],s);n=o=null}(n=DOM.appendDIV(a,"ago_phalanx_fleet"),t),n=DOM.appendDIV(a,"ago_phalanx_right"),e.parentNode.appendChild(a),a=a=n=null)},toggleDisplay:function(e){var t;e.target&&(e=document.getElementById("phalanxWrap"))&&(t="1"===e.parentNode.parentNode.getAttribute("ago_display_status")?2:1,e.parentNode.parentNode.setAttribute("ago_display_status",t),AGO.Option.set("E23",t,2))},click:function(e){var t;e&&e.target&&(HTML.hasClass(e.target.parentNode.className,"countDown")||HTML.hasClass(e.target.className,"countDown"))&&(e=NMR.parseIntAbs(e.target.id),e=AGO.Phalanx.Data[e])&&((t={action:"set",tab:"Target",marked:2,token:81,time:e.arrival}).coords=e.reverse?e.coordsOrigin+":"+e.typeOrigin:e.coords+":"+e.type,AGO.Init.Messages("Token","Action",t))}},AGO.Techtree={Messages:function(e,t){AGO.dummy=e+t},Content:function(e){(e=e?e.querySelector("div.techtree"):null)&&!e.hasAttribute("ago-status")&&e.setAttribute("ago-status",1)}},AGO.Buddies={Messages:function(e,t){AGO.dummy=e+t},Content:function(e){var t,a;if((e=e?e.querySelector("#buddylist"):null)&&DOM.updateAttribute(e,null,"ago-status",1,8)&&AGO.Option.is("D20"))for(e=e.querySelectorAll("tr"),a=0;a<e.length;a++)(t=NMR.parseIntAbs(STR.getParameter("to",DOM.getAttribute('a[href*="page=writemessage"]',e[a],"href"))))&&(t={page:"Panel",role:"Action",data:{mode:"set",tab:"Player",token:81,id:t,coords:AGO.Task.trimCoords(DOM.getText("td:nth-child(6) a",e[a])),name:AGO.Task.valid(DOM.getText("td:nth-child(2) span",e[a]))}},DOM.set(e[a],null,null,null,{click:AGO.Buddies.click}),DOM.addClass("td:nth-child(2)",e[a],"ago_action"),DOM.setData("td:nth-child(2)",e[a],t))},click:function(e){e&&e.target&&e.currentTarget&&(e=DOM.getData(e.target,null,2),AGO.Init.Messages(e.page,e.role,e.data))}},AGO.Notices={Messages:function(e,t){AGO.dummy=e+t},Content:function(e){(e=e?e.querySelector("#notizen"):null)&&!e.hasAttribute("ago-status")&&e.setAttribute("ago-status",1)}},AGO.Search={Messages:function(e,t){AGO.dummy=e+t},Content:function(e,t,a,n,o){if(t=+STR.getParameter("method",o)||0,(e=e?e.querySelector(".searchresults"):null)&&DOM.updateAttribute(e,null,"ago-status",1,8)&&(2===t||3===t)&&AGO.Option.is("D20"))for(e=e.querySelectorAll("tr"),n=0;n<e.length;n++)(o=NMR.parseIntAbs(STR.getParameter("to",DOM.getAttribute(".action a",e[n],"href"))))&&(t=AGO.Task.valid(DOM.getText("td.userName",e[n])),a=AGO.Task.trimCoords(DOM.getText("td.position a",e[n])),DOM.set(e[n],null,null,null,{click:AGO.Search.click}),o={message:{page:"Token",role:"Action",data:{action:"set",tab:"Player",token:81,id:o,name:t,coords:a}}},DOM.addClass("td.userName",e[n],"ago_action"),DOM.setData("td.userName",e[n],o),o={message:{page:"Token",role:"Action",data:{action:"set",tab:"Target",token:81,name:t,coords:a}}},DOM.setData("td.position",e[n],o))},click:function(e){e&&e.target&&((e=DOM.getData(e.target,null,2)).message&&AGO.Init.Messages(e.message.page,e.message.role,e.message.data))}};