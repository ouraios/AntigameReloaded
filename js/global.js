window.addEventListener("ago_global",function(e){var t;try{t=JSON.parse(e.detail||"{}")}catch(e){t={}}switch(t.role){case"Interactive":AGO.Interactive(t.data);break;case"Ready":AGO.Ready();break;case"Data":if(t.data)for(var a in t.data)t.data.hasOwnProperty(a)&&(AGO.Data[a]=t.data[a]);break;case"setProperty":t.property&&(window[t.property]=t.value);break;case"getProperty":t.property&&AGO.setData(t.property,JSON.stringify(window[t.property]));break;case"sendShips":window.sendShips(t.mission,t.galaxy,t.system,t.position,t.type,0,t.message);break;case"reloadEvents":$.get("/game/index.php?page=eventList&ajax=1",function(e){$("#eventboxContent").html(e)});break;case"hideAll":try{window.Tipped.hideAll()}catch(e){}break;case"Jumpgate":AGO.Jumpgate();break;case"setMostShips":t.data&&window.setMaxIntInput("#jumpgateForm",t.data);break;case"updateVariablesTimes":window.updateVariables(),window.updateTimesFleet2();break;case"setType":window.setTType(t.value),window.modifyPlanetName(),window.checkOk();break;case"checkOk":window.checkOk();break;case"maximalSpeed":for(e=window.speed,t=window.duration,a=window.consumption,window.speed=10;;){if(window.duration=window.getDuration(),window.consumption=window.getConsumption(),!(1<window.speed&&(window.consumption>window.storageCapacity||window.consumption>window.currentDeuterium)))break;window.speed--}AGO.setData("maximalSpeed",JSON.stringify(window.speed)),window.speed=e,window.duration=t,window.consumption=a;break;case"updateTimesFleet3":window.updateTimesFleet3();break;case"updateHoldingOrExpTime":window.updateHoldingOrExpTime(),window.updateVariables();break;case"executeAction":t.msgIds&&window.executeAction(t.msgIds,t.actionMode)}},!1);var AGO={Data:{},message:function(e,t,a){window.dispatchEvent(new window.CustomEvent("ago_global_send",{detail:JSON.stringify({page:e||"",role:t||"",data:a||""})}))},setData:function(e,t){var a=document.getElementById("ago_global_data");a&&a.setAttribute("ago-data-"+e,t||"")},getData:function(e){var t=document.getElementById("ago_global_data");if(t)return t.getAttribute("ago-data-"+e)||""},Interactive:function(e){var a,n,o;AGO.Data=e||{},AGO.Tooltip(),AGO.Data.F00&&AGO.Fleet(),(a=1<AGO.Data.timeStatus?AGO.Data.timeZoneDelta:0)&&(n=window.getFormatedDate,window.getFormatedDate=function(e,t){return n(e+a,t)}),o=window.toggleMaxShips,window.toggleMaxShips=function(e,t,a){var n;("#shipsChosen"===e&&AGO.Data.F00||"#jumpgateForm"===e&&AGO.Data.G30)&&(0<(n=(n=document.querySelector(e+" #ship_"+t))&&+n.value||0)&&n!==a&&(a-=n)),o(e,t,a)},window.shipsendingDone=1,window.sendShips=function(e,t,a,n,o,i,s){s=s||"",1==+window.shipsendingDone&&(window.shipsendingDone=0,a={mission:e,galaxy:t,system:a,position:n,type:o,shipCount:i,token:window.miniFleetToken},6==+e&&(t=Math.abs(AGO.Data.galaxy-t),a.speed=6<=t?1:5<=t?2:4<=t?4:3<=t?6:2<=t?9:10),$.ajax(window.miniFleetLink,{data:a,dataType:"json",type:"POST",success:function(e){window.shipsendingDone=1,void 0!==e.newToken&&(window.miniFleetToken=e.newToken);try{window.displayMiniFleetMessage(e.response)}catch(e){}}}),AGO.message("Page","sendShips",{mission:e,mode:"start",message:s}))}},Ready:function(){$(document).ready(function(){AGO.message("Init","Ready"),window.timerHandler&&window.timerHandler.appendCallback(function(){AGO.message("Init","Timer")})}),$(document).ajaxSuccess(function(e,t,a){e=((e=decodeURIComponent(a.url||"").replace(/\?/g,"&").split("&page=")[1])||"").toLowerCase().split("&")[0].split("#")[0],AGO.message("Init","Content",{page:e,url:a.url,para:a.data,response:("fetcheventbox"===e||"minifleet"===e)&&t.responseText||""})})},Tooltip:function(){function w(e,t){return!!t&&-1<(" "+(e||"").toLowerCase()+" ").indexOf(" "+t.toLowerCase().trim()+" ")}var p;AGO.TooltipQueue=0,p=window.getTooltipOptions,window.getTooltipOptions=function(e){function t(e){AGO.TooltipQueue++,$(e).attr("ago-tooltip",AGO.TooltipQueue),AGO.message("Init","Tooltip",AGO.TooltipQueue)}var a,n,o,i,s,d,r;return a=p(e),n=$(e).attr("class")||"",i=AGO.Data.U60,s=AGO.Data.U61,d=!1,r=+AGO.Data.U62||0,o=AGO.Data.page,-1<n.indexOf("ago_menu_help")?(i=!0,r=Math.max(r,5),a.hideOthers=!0,a.maxWidth=Math.max(Math.min(600,window.innerWidth-30),0),n.indexOf(!1)?a.hook={target:"topleft",tooltip:"bottomleft"}:(a.hideOn=[{element:"target",event:"mouseleave"},{element:"tooltip",event:"mouseleave"}],a.hook={target:"leftmiddle",tooltip:"rightmiddle"}),t(e)):w(n,"planetlink")?(d=s,AGO.Data.O51&&(a.hook={target:"leftmiddle",tooltip:"rightmiddle"})):w(n,"moonlink")?(d=s,AGO.Data.O51&&(a.hook={target:"rightmiddle",tooltip:"leftmiddle"})):w(n,"constructionIcon")?AGO.Data.O53&&(d=i):(i||"galaxy"===o)&&w(n,"tooltipClose")?("galaxy"===o?(r=+AGO.Data.U67||0,(w(n,"microplanet")||w(n,"moon")&&(AGO.Data.commander||!w(n,"ago_galaxy_espionage")))&&$("#galaxytable.ago_galaxy_espionage").length&&(d=i),t(e)):r=+AGO.Data.U66||0,AGO.Data.U65&&(a.hideAfter=Math.max(100*(+AGO.Data.U65||0),300),a.hideDelay=a.hideAfter,a.hideOthers=!0)):i&&("overview"===o?w(n,"tooltipLeft")&&$(e).parent().hasClass("planetMoveStart")?s=!0:w(n,"tooltipBottom")&&("moon"===(e=$(e).parent().attr("id"))||"planet_as_moon"===e)&&(d=s):"resources"===o||"station"===o||"research"===o||"shipyard"===o||"defense"===o?w(n,"slideIn")?s=1===AGO.Data.B21||3===AGO.Data.B21:w(n,"tooltip")&&"resources"===$(e).parent().attr("id")?s=!1:"maxlink"===$(e).attr("id")&&(d=s):"fleet1"===o?-1<($(e).attr("onclick")||"").indexOf("toggleMaxShips")&&(s=1===AGO.Data.F02||3===AGO.Data.F02):"fleet2"!==o&&"fleet2"!==o&&"movement"!==o&&("galaxy"===o?w(n,"activity ")?s=!0:$(e).parent().hasClass("buildingimg")&&(s=!1):"galaxy"===o?s=!1:"messages"===o?"button"===$(e).attr("type")&&(s=!1):s=!1),w(n,"tooltip")&&(d=s)),d?a.showOn=!1:i&&(a.showDelay=Math.max(100*r,100)),a}},Jumpgate:function(){var e,a;e=window.jumpToTarget,window.jumpToTarget=function(){AGO.Data.G34?document.location.href=document.location.href.split("?")[0]+"?page=fleet1":e()},a=window.jumpgateDone,window.jumpgateDone=function(e){var t;try{t=JSON.parse(e)}catch(e){t={}}t.status&&AGO.message("Jumpgate","Continue",t.targetMoon),t.status&&AGO.Data.G33?(t.errorbox={},a(JSON.stringify(t)),window.jumpToTarget()):a(e)}},Fleet:function(){if("fleet1"===AGO.Data.page){var n=window.checkShips;window.checkShips=function(e,t,a){n(e,t,a),AGO.message("Page","Display")};var o=window.clearInput;window.clearInput=function(e,t,a){o(e,t,a),AGO.message("Page","Display")}}else if("fleet2"===AGO.Data.page){var i=window.updateVariables;window.updateVariables=function(e,t,a){i(),window.updateTimesFleet2()},o=window.clearInput,window.clearInput=function(e,t,a){try{e&&e.value&&e.setAttribute("ago_value",e.value)}catch(e){}o(e,t,a)};var t=window.setTType;window.setTType=function(e){if(e){try{AGO.setData("type",e),AGO.message("Page","clickType"),e=+AGO.getData("type")||0}catch(e){}e&&t(e)}else t()};var e=window.checkOk;window.checkOk=function(){e(),AGO.message("Page","Display")};var s=window.shortLinkChange;window.shortLinkChange=function(e,t,a){s(e,t,a),e&&window.handleUnion()},window.getFreeStorage=function(){return window.cargoCapacity}}else if("fleet3"===AGO.Data.page){i=window.updateVariables,window.updateVariables=function(){i(),AGO.message("Page","Display")};var a=window.checkRessourceByType;window.checkRessourceByType=function(e){window[e+"OnPlanet"]=parseInt(($("#resources_"+e).text()||"").replace(/[^\d\-]/g,""),10),a(e)}}var d=window.trySubmit;window.trySubmit=function(){try{document.activeElement.blur()}catch(e){}d(),window.validated&&AGO.message("Page","Continue")}}};